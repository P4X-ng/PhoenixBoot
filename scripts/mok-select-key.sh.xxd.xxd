00000000: 3030 3030 3030 3030 3a20 3233 3231 2032  00000000: 2321 2
00000010: 6637 3520 3733 3732 2032 6636 3220 3639  f75 7372 2f62 69
00000020: 3665 2032 6636 3520 3665 3736 2032 3036  6e 2f65 6e76 206
00000030: 3220 2023 212f 7573 722f 6269 6e2f 656e  2  #!/usr/bin/en
00000040: 7620 620a 3030 3030 3030 3130 3a20 3631  v b.00000010: 61
00000050: 3733 2036 3830 6120 3733 3635 2037 3432  73 680a 7365 742
00000060: 3020 3264 3635 2037 3536 6620 3230 3730  0 2d65 756f 2070
00000070: 2036 3937 3020 2061 7368 2e73 6574 202d   6970  ash.set -
00000080: 6575 6f20 7069 700a 3030 3030 3030 3230  euo pip.00000020
00000090: 3a20 3635 3636 2036 3136 3920 3663 3061  : 6566 6169 6c0a
000000a0: 2036 3336 3420 3230 3232 2032 3432 3820   6364 2022 2428 
000000b0: 3634 3639 2037 3236 6520 2065 6661 696c  6469 726e  efail
000000c0: 2e63 6420 2224 2864 6972 6e0a 3030 3030  .cd "$(dirn.0000
000000d0: 3030 3330 3a20 3631 3664 2036 3532 3020  0030: 616d 6520 
000000e0: 3232 3234 2033 3032 3220 3239 3266 2032  2224 3022 292f 2
000000f0: 6532 6520 3232 3061 2030 6132 3320 2061  e2e 220a 0a23  a
00000100: 6d65 2022 2430 2229 2f2e 2e22 2e2e 230a  me "$0")/.."..#.
00000110: 3030 3030 3030 3430 3a20 3230 3439 2036  00000040: 2049 6
00000120: 6537 3420 3635 3732 2036 3136 3320 3734  e74 6572 6163 74
00000130: 3639 2037 3636 3520 3230 3666 2037 3232  69 7665 206f 722
00000140: 3020 2020 496e 7465 7261 6374 6976 6520  0   Interactive 
00000150: 6f72 200a 3030 3030 3030 3530 3a20 3635  or .00000050: 65
00000160: 3665 2037 3632 6420 3634 3732 2036 3937  6e 762d 6472 697
00000170: 3620 3635 3665 2032 3037 3320 3635 3663  6 656e 2073 656c
00000180: 2036 3536 3320 2065 6e76 2d64 7269 7665   6563  env-drive
00000190: 6e20 7365 6c65 630a 3030 3030 3030 3630  n selec.00000060
000001a0: 3a20 3734 3639 2036 6636 6520 3230 3666  : 7469 6f6e 206f
000001b0: 2036 3632 3020 3631 3230 2034 6434 6620   6620 6120 4d4f 
000001c0: 3462 3230 2036 3336 3520 2074 696f 6e20  4b20 6365  tion 
000001d0: 6f66 2061 204d 4f4b 2063 650a 3030 3030  of a MOK ce.0000
000001e0: 3030 3730 3a20 3732 3734 2032 6236 6220  0070: 7274 2b6b 
000001f0: 3635 3739 2032 3036 3620 3666 3732 2032  6579 2066 6f72 2
00000200: 3036 6420 3666 3634 2037 3536 6320 2072  06d 6f64 756c  r
00000210: 742b 6b65 7920 666f 7220 6d6f 6475 6c0a  t+key for modul.
00000220: 3030 3030 3030 3830 3a20 3635 3230 2037  00000080: 6520 7
00000230: 3336 3920 3637 3665 2036 3936 6520 3637  369 676e 696e 67
00000240: 3265 2030 6132 3320 3230 3535 2037 3336  2e 0a23 2055 736
00000250: 3120 2065 2073 6967 6e69 6e67 2e2e 2320  1  e signing..# 
00000260: 5573 610a 3030 3030 3030 3930 3a20 3637  Usa.00000090: 67
00000270: 3635 2033 6130 6120 3233 3230 2032 3032  65 3a0a 2320 202
00000280: 3020 3465 3666 2036 6532 6420 3639 3665  0 4e6f 6e2d 696e
00000290: 2037 3436 3520 2067 653a 2e23 2020 204e   7465  ge:.#   N
000002a0: 6f6e 2d69 6e74 650a 3030 3030 3030 6130  on-inte.000000a0
000002b0: 3a20 3732 3631 2036 3337 3420 3639 3736  : 7261 6374 6976
000002c0: 2036 3532 3020 3238 3730 2037 3236 3520   6520 2870 7265 
000002d0: 3636 3635 2037 3237 3220 2072 6163 7469  6665 7272  racti
000002e0: 7665 2028 7072 6566 6572 720a 3030 3030  ve (preferr.0000
000002f0: 3030 6230 3a20 3635 3634 2032 3933 6120  00b0: 6564 293a 
00000300: 3230 3733 2036 3537 3420 3230 3462 2034  2073 6574 204b 4
00000310: 6434 6620 3434 3566 2034 3334 3520 2065  d4f 445f 4345  e
00000320: 6429 3a20 7365 7420 4b4d 4f44 5f43 450a  d): set KMOD_CE.
00000330: 3030 3030 3030 6330 3a20 3532 3534 2032  000000c0: 5254 2
00000340: 6634 6220 3464 3466 2034 3435 6620 3462  f4b 4d4f 445f 4b
00000350: 3435 2035 3932 6320 3230 3734 2036 3836  45 592c 2074 686
00000360: 3520 2052 542f 4b4d 4f44 5f4b 4559 2c20  5  RT/KMOD_KEY, 
00000370: 7468 650a 3030 3030 3030 6430 3a20 3665  the.000000d0: 6e
00000380: 3230 2037 3237 3520 3665 3230 2037 3436  20 7275 6e20 746
00000390: 3820 3639 3733 2032 3037 3420 3666 3230  8 6973 2074 6f20
000003a0: 2037 3636 3520 206e 2072 756e 2074 6869   7665  n run thi
000003b0: 7320 746f 2076 650a 3030 3030 3030 6530  s to ve.000000e0
000003c0: 3a20 3732 3639 2036 3637 3920 3061 3233  : 7269 6679 0a23
000003d0: 2032 3032 3020 3230 3439 2036 6537 3420   2020 2049 6e74 
000003e0: 3635 3732 2036 3136 3320 2072 6966 792e  6572 6163  rify.
000003f0: 2320 2020 496e 7465 7261 630a 3030 3030  #   Interac.0000
00000400: 3030 6630 3a20 3734 3639 2037 3636 3520  00f0: 7469 7665 
00000410: 3361 3230 2037 3237 3520 3665 3230 2037  3a20 7275 6e20 7
00000420: 3736 3920 3734 3638 2032 3036 6520 2074  769 7468 206e  t
00000430: 6976 653a 2072 756e 2077 6974 6820 6e0a  ive: run with n.
00000440: 3030 3030 3031 3030 3a20 3666 3230 2036  00000100: 6f20 6
00000450: 3536 6520 3736 3362 2032 3037 3020 3639  56e 763b 2070 69
00000460: 3633 2036 6232 3020 3631 3665 2032 3036  63 6b20 616e 206
00000470: 3520 206f 2065 6e76 3b20 7069 636b 2061  5  o env; pick a
00000480: 6e20 650a 3030 3030 3031 3130 3a20 3665  n e.00000110: 6e
00000490: 3732 2036 6636 6320 3663 3635 2036 3432  72 6f6c 6c65 642
000004a0: 3020 3633 3635 2037 3237 3420 3230 3734  0 6365 7274 2074
000004b0: 2036 3836 3120 206e 726f 6c6c 6564 2063   6861  nrolled c
000004c0: 6572 7420 7468 610a 3030 3030 3031 3230  ert tha.00000120
000004d0: 3a20 3734 3230 2036 3836 3120 3733 3230  : 7420 6861 7320
000004e0: 2036 3132 3020 3664 3631 2037 3436 3320   6120 6d61 7463 
000004f0: 3638 3639 2036 6536 3720 2074 2068 6173  6869 6e67  t has
00000500: 2061 206d 6174 6368 696e 670a 3030 3030   a matching.0000
00000510: 3031 3330 3a20 3230 3662 2036 3537 3920  0130: 206b 6579 
00000520: 3061 3233 2032 3034 6620 3735 3734 2037  0a23 204f 7574 7
00000530: 3037 3520 3734 3361 2030 6132 3320 2020  075 743a 0a23   
00000540: 6b65 792e 2320 4f75 7470 7574 3a2e 230a  key.# Output:.#.
00000550: 3030 3030 3031 3430 3a20 3230 3230 2032  00000140: 2020 2
00000560: 3035 3020 3732 3639 2036 6537 3420 3733  050 7269 6e74 73
00000570: 3230 2036 3036 3520 3738 3730 2036 6637  20 6065 7870 6f7
00000580: 3220 2020 2020 5072 696e 7473 2060 6578  2     Prints `ex
00000590: 706f 720a 3030 3030 3031 3530 3a20 3734  por.00000150: 74
000005a0: 3230 2034 6234 6420 3466 3434 2035 6634  20 4b4d 4f44 5f4
000005b0: 3320 3435 3532 2035 3433 6420 3265 3265  3 4552 543d 2e2e
000005c0: 2032 6536 3020 2074 204b 4d4f 445f 4345   2e60  t KMOD_CE
000005d0: 5254 3d2e 2e2e 600a 3030 3030 3031 3630  RT=...`.00000160
000005e0: 3a20 3230 3631 2036 6536 3420 3230 3630  : 2061 6e64 2060
000005f0: 2036 3537 3820 3730 3666 2037 3237 3420   6578 706f 7274 
00000600: 3230 3462 2034 6434 6620 2020 616e 6420  204b 4d4f   and 
00000610: 6065 7870 6f72 7420 4b4d 4f0a 3030 3030  `export KMO.0000
00000620: 3031 3730 3a20 3434 3566 2034 6234 3520  0170: 445f 4b45 
00000630: 3539 3364 2032 6532 6520 3265 3630 2032  593d 2e2e 2e60 2
00000640: 3036 6620 3665 3230 2037 3337 3420 2044  06f 6e20 7374  D
00000650: 5f4b 4559 3d2e 2e2e 6020 6f6e 2073 740a  _KEY=...` on st.
00000660: 3030 3030 3031 3830 3a20 3634 3666 2037  00000180: 646f 7
00000670: 3537 3420 3061 3061 2034 6434 6620 3462  574 0a0a 4d4f 4b
00000680: 3566 2034 3434 3920 3532 3364 2032 3236  5f 4449 523d 226
00000690: 6620 2064 6f75 742e 2e4d 4f4b 5f44 4952  f  dout..MOK_DIR
000006a0: 3d22 6f0a 3030 3030 3031 3930 3a20 3735  ="o.00000190: 75
000006b0: 3734 2032 6636 6220 3635 3739 2037 3332  74 2f6b 6579 732
000006c0: 6620 3664 3666 2036 6232 3220 3061 3463  f 6d6f 6b22 0a4c
000006d0: 2034 3534 3720 2075 742f 6b65 7973 2f6d   4547  ut/keys/m
000006e0: 6f6b 222e 4c45 470a 3030 3030 3031 6130  ok".LEG.000001a0
000006f0: 3a20 3431 3433 2035 3935 6620 3434 3439  : 4143 595f 4449
00000700: 2035 3233 6420 3232 3666 2037 3537 3420   523d 226f 7574 
00000710: 3266 3662 2036 3537 3920 2041 4359 5f44  2f6b 6579  ACY_D
00000720: 4952 3d22 6f75 742f 6b65 790a 3030 3030  IR="out/key.0000
00000730: 3031 6230 3a20 3733 3232 2030 6130 6120  01b0: 7322 0a0a 
00000740: 3663 3639 2037 3337 3420 3566 3730 2036  6c69 7374 5f70 6
00000750: 3136 3920 3732 3733 2032 3832 3920 2073  169 7273 2829  s
00000760: 222e 2e6c 6973 745f 7061 6972 7328 290a  "..list_pairs().
00000770: 3030 3030 3031 6330 3a20 3230 3762 2030  000001c0: 207b 0
00000780: 6132 3020 3230 3233 2032 3035 3920 3639  a20 2023 2059 69
00000790: 3635 2036 6336 3420 3230 3663 2036 3936  65 6c64 206c 696
000007a0: 6520 2020 7b2e 2020 2320 5969 656c 6420  e   {.  # Yield 
000007b0: 6c69 6e0a 3030 3030 3031 6430 3a20 3635  lin.000001d0: 65
000007c0: 3733 2033 6132 3020 3433 3435 2035 3235  73 3a20 4345 525
000007d0: 3420 3566 3530 2034 3135 3420 3438 3763  4 5f50 4154 487c
000007e0: 2034 6234 3520 2065 733a 2043 4552 545f   4b45  es: CERT_
000007f0: 5041 5448 7c4b 450a 3030 3030 3031 6530  PATH|KE.000001e0
00000800: 3a20 3539 3566 2035 3034 3120 3534 3438  : 595f 5041 5448
00000810: 2037 6334 3520 3465 3532 2034 6634 6320   7c45 4e52 4f4c 
00000820: 3463 3435 2034 3432 3820 2059 5f50 4154  4c45 4428  Y_PAT
00000830: 487c 454e 524f 4c4c 4544 280a 3030 3030  H|ENROLLED(.0000
00000840: 3031 6630 3a20 3539 3266 2034 6532 3920  01f0: 592f 4e29 
00000850: 3763 3533 2034 3834 3120 3331 3061 2032  7c53 4841 310a 2
00000860: 3032 3020 3733 3633 2036 3136 6520 2059  020 7363 616e  Y
00000870: 2f4e 297c 5348 4131 2e20 2073 6361 6e0a  /N)|SHA1.  scan.
00000880: 3030 3030 3032 3030 3a20 3566 3634 2036  00000200: 5f64 6
00000890: 3937 3220 3238 3239 2032 3037 6220 3061  972 2829 207b 0a
000008a0: 3230 2032 3032 3020 3230 3663 2036 6636  20 2020 206c 6f6
000008b0: 3320 205f 6469 7228 2920 7b2e 2020 2020  3  _dir() {.    
000008c0: 6c6f 630a 3030 3030 3032 3130 3a20 3631  loc.00000210: 61
000008d0: 3663 2032 3036 3420 3364 3232 2032 3433  6c 2064 3d22 243
000008e0: 3120 3232 3061 2032 3032 3020 3230 3230  1 220a 2020 2020
000008f0: 2035 6232 3020 2061 6c20 643d 2224 3122   5b20  al d="$1"
00000900: 2e20 2020 205b 200a 3030 3030 3032 3230  .    [ .00000220
00000910: 3a20 3264 3634 2032 3032 3220 3234 3634  : 2d64 2022 2464
00000920: 2032 3232 3020 3564 3230 2037 6337 6320   2220 5d20 7c7c 
00000930: 3230 3732 2036 3537 3420 202d 6420 2224  2072 6574  -d "$
00000940: 6422 205d 207c 7c20 7265 740a 3030 3030  d" ] || ret.0000
00000950: 3032 3330 3a20 3735 3732 2036 6532 3020  0230: 7572 6e20 
00000960: 3330 3061 2032 3032 3020 3230 3230 2036  300a 2020 2020 6
00000970: 3636 3920 3665 3634 2032 3032 3220 2075  669 6e64 2022  u
00000980: 726e 2030 2e20 2020 2066 696e 6420 220a  rn 0.    find ".
00000990: 3030 3030 3032 3430 3a20 3234 3634 2032  00000240: 2464 2
000009a0: 3232 3020 3264 3664 2036 3137 3820 3634  220 2d6d 6178 64
000009b0: 3635 2037 3037 3420 3638 3230 2033 3232  65 7074 6820 322
000009c0: 3020 2024 6422 202d 6d61 7864 6570 7468  0  $d" -maxdepth
000009d0: 2032 200a 3030 3030 3032 3530 3a20 3264   2 .00000250: 2d
000009e0: 3734 2037 3937 3020 3635 3230 2036 3632  74 7970 6520 662
000009f0: 3020 3563 3238 2032 3032 6420 3665 3631  0 5c28 202d 6e61
00000a00: 2036 6436 3520 202d 7479 7065 2066 205c   6d65  -type f \
00000a10: 2820 2d6e 616d 650a 3030 3030 3032 3630  ( -name.00000260
00000a20: 3a20 3230 3237 2032 6132 6520 3633 3732  : 2027 2a2e 6372
00000a30: 2037 3432 3720 3230 3264 2036 6632 3020   7427 202d 6f20 
00000a40: 3264 3665 2036 3136 6420 2020 272a 2e63  2d6e 616d   '*.c
00000a50: 7274 2720 2d6f 202d 6e61 6d0a 3030 3030  rt' -o -nam.0000
00000a60: 3032 3730 3a20 3635 3230 2032 3732 6120  0270: 6520 272a 
00000a70: 3265 3730 2036 3536 6420 3237 3230 2032  2e70 656d 2720 2
00000a80: 6436 6620 3230 3264 2036 6536 3120 2065  d6f 202d 6e61  e
00000a90: 2027 2a2e 7065 6d27 202d 6f20 2d6e 610a   '*.pem' -o -na.
00000aa0: 3030 3030 3032 3830 3a20 3664 3635 2032  00000280: 6d65 2
00000ab0: 3032 3720 3261 3265 2036 3336 3520 3732  027 2a2e 6365 72
00000ac0: 3237 2032 3032 6420 3666 3230 2032 6436  27 202d 6f20 2d6
00000ad0: 6520 206d 6520 272a 2e63 6572 2720 2d6f  e  me '*.cer' -o
00000ae0: 202d 6e0a 3030 3030 3032 3930 3a20 3631   -n.00000290: 61
00000af0: 3664 2036 3532 3020 3237 3261 2032 6536  6d 6520 272a 2e6
00000b00: 3420 3635 3732 2032 3732 3020 3563 3239  4 6572 2720 5c29
00000b10: 2032 3037 6320 2061 6d65 2027 2a2e 6465   207c  ame '*.de
00000b20: 7227 205c 2920 7c0a 3030 3030 3032 6130  r' \) |.000002a0
00000b30: 3a20 3230 3737 2036 3836 3920 3663 3635  : 2077 6869 6c65
00000b40: 2032 3037 3220 3635 3631 2036 3432 3020   2072 6561 6420 
00000b50: 3264 3732 2032 3036 3320 2020 7768 696c  2d72 2063   whil
00000b60: 6520 7265 6164 202d 7220 630a 3030 3030  e read -r c.0000
00000b70: 3032 6230 3a20 3635 3732 2037 3433 6220  02b0: 6572 743b 
00000b80: 3230 3634 2036 6630 6120 3230 3230 2032  2064 6f0a 2020 2
00000b90: 3032 3020 3230 3230 2036 6336 6620 2065  020 2020 6c6f  e
00000ba0: 7274 3b20 646f 2e20 2020 2020 206c 6f0a  rt; do.      lo.
00000bb0: 3030 3030 3032 6330 3a20 3633 3631 2036  000002c0: 6361 6
00000bc0: 6332 3020 3632 3631 2037 3336 3520 3364  c20 6261 7365 3d
00000bd0: 3232 2032 3437 6220 3633 3635 2037 3237  22 247b 6365 727
00000be0: 3420 2063 616c 2062 6173 653d 2224 7b63  4  cal base="${c
00000bf0: 6572 740a 3030 3030 3032 6430 3a20 3235  ert.000002d0: 25
00000c00: 3265 2032 6137 6420 3232 3061 2032 3032  2e 2a7d 220a 202
00000c10: 3020 3230 3230 2032 3032 3020 3663 3666  0 2020 2020 6c6f
00000c20: 2036 3336 3120 2025 2e2a 7d22 2e20 2020   6361  %.*}".   
00000c30: 2020 206c 6f63 610a 3030 3030 3032 6530     loca.000002e0
00000c40: 3a20 3663 3230 2036 6236 3520 3739 3364  : 6c20 6b65 793d
00000c50: 2032 3232 3220 3061 3230 2032 3032 3020   2222 0a20 2020 
00000c60: 3230 3230 2032 3036 3620 206c 206b 6579  2020 2066  l key
00000c70: 3d22 222e 2020 2020 2020 660a 3030 3030  ="".      f.0000
00000c80: 3032 6630 3a20 3666 3732 2032 3036 6220  02f0: 6f72 206b 
00000c90: 3230 3639 2036 6532 3020 3232 3234 2036  2069 6e20 2224 6
00000ca0: 3236 3120 3733 3635 2032 6536 6220 206f  261 7365 2e6b  o
00000cb0: 7220 6b20 696e 2022 2462 6173 652e 6b0a  r k in "$base.k.
00000cc0: 3030 3030 3033 3030 3a20 3635 3739 2032  00000300: 6579 2
00000cd0: 3232 3020 3232 3234 2037 6236 3220 3631  220 2224 7b62 61
00000ce0: 3733 2036 3532 3520 3235 3265 2036 3337  73 6525 252e 637
00000cf0: 3220 2065 7922 2022 247b 6261 7365 2525  2  ey" "${base%%
00000d00: 2e63 720a 3030 3030 3033 3130 3a20 3734  .cr.00000310: 74
00000d10: 3764 2032 6536 6220 3635 3739 2032 3233  7d 2e6b 6579 223
00000d20: 6220 3230 3634 2036 6630 6120 3230 3230  b 2064 6f0a 2020
00000d30: 2032 3032 3020 2074 7d2e 6b65 7922 3b20   2020  t}.key"; 
00000d40: 646f 2e20 2020 200a 3030 3030 3033 3230  do.    .00000320
00000d50: 3a20 3230 3230 2032 3032 3020 3562 3230  : 2020 2020 5b20
00000d60: 2032 6436 3620 3230 3232 2032 3436 6220   2d66 2022 246b 
00000d70: 3232 3230 2035 6432 3020 2020 2020 205b  2220 5d20      [
00000d80: 202d 6620 2224 6b22 205d 200a 3030 3030   -f "$k" ] .0000
00000d90: 3033 3330 3a20 3236 3236 2032 3037 6220  0330: 2626 207b 
00000da0: 3230 3662 2036 3537 3920 3364 3232 2032  206b 6579 3d22 2
00000db0: 3436 6220 3232 3362 2032 3036 3220 2026  46b 223b 2062  &
00000dc0: 2620 7b20 6b65 793d 2224 6b22 3b20 620a  & { key="$k"; b.
00000dd0: 3030 3030 3033 3430 3a20 3732 3635 2036  00000340: 7265 6
00000de0: 3136 6220 3362 3230 2037 6430 6120 3230  16b 3b20 7d0a 20
00000df0: 3230 2032 3032 3020 3230 3230 2036 3436  20 2020 2020 646
00000e00: 6620 2072 6561 6b3b 207d 2e20 2020 2020  f  reak; }.     
00000e10: 2064 6f0a 3030 3030 3033 3530 3a20 3665   do.00000350: 6e
00000e20: 3635 2030 6132 3020 3230 3230 2032 3032  65 0a20 2020 202
00000e30: 3020 3230 3562 2032 3032 6420 3665 3230  0 205b 202d 6e20
00000e40: 2032 3232 3420 206e 652e 2020 2020 2020   2224  ne.      
00000e50: 5b20 2d6e 2022 240a 3030 3030 3033 3630  [ -n "$.00000360
00000e60: 3a20 3662 3635 2037 3932 3220 3230 3564  : 6b65 7922 205d
00000e70: 2032 3037 6320 3763 3230 2036 3336 6620   207c 7c20 636f 
00000e80: 3665 3734 2036 3936 6520 206b 6579 2220  6e74 696e  key" 
00000e90: 5d20 7c7c 2063 6f6e 7469 6e0a 3030 3030  ] || contin.0000
00000ea0: 3033 3730 3a20 3735 3635 2030 6132 3020  0370: 7565 0a20 
00000eb0: 3230 3230 2032 3032 3020 3230 3663 2036  2020 2020 206c 6
00000ec0: 6636 3320 3631 3663 2032 3036 3620 2075  f63 616c 2066  u
00000ed0: 652e 2020 2020 2020 6c6f 6361 6c20 660a  e.      local f.
00000ee0: 3030 3030 3033 3830 3a20 3730 3061 2032  00000380: 700a 2
00000ef0: 3032 3020 3230 3230 2032 3032 3020 3633  020 2020 2020 63
00000f00: 3631 2037 3336 3520 3230 3232 2032 3437  61 7365 2022 247
00000f10: 6220 2070 2e20 2020 2020 2063 6173 6520  b  p.      case 
00000f20: 2224 7b0a 3030 3030 3033 3930 3a20 3633  "${.00000390: 63
00000f30: 3635 2037 3237 3420 3233 3233 2032 6132  65 7274 2323 2a2
00000f40: 6520 3764 3232 2032 3036 3920 3665 3061  e 7d22 2069 6e0a
00000f50: 2032 3032 3020 2063 6572 7423 232a 2e7d   2020  cert##*.}
00000f60: 2220 696e 2e20 200a 3030 3030 3033 6130  " in.  .000003a0
00000f70: 3a20 3230 3230 2032 3032 3020 3230 3230  : 2020 2020 2020
00000f80: 2036 3436 3520 3732 3763 2036 3336 3520   6465 727c 6365 
00000f90: 3732 3239 2032 3036 3620 2020 2020 2020  7229 2066       
00000fa0: 2064 6572 7c63 6572 2920 660a 3030 3030   der|cer) f.0000
00000fb0: 3033 6230 3a20 3730 3364 2032 3432 3820  03b0: 703d 2428 
00000fc0: 3666 3730 2036 3536 6520 3733 3733 2036  6f70 656e 7373 6
00000fd0: 6332 3020 3738 3335 2033 3033 3920 2070  c20 7835 3039  p
00000fe0: 3d24 286f 7065 6e73 736c 2078 3530 390a  =$(openssl x509.
00000ff0: 3030 3030 3033 6330 3a20 3230 3264 2036  000003c0: 202d 6
00001000: 3936 6520 3636 3666 2037 3236 6420 3230  96e 666f 726d 20
00001010: 3434 2034 3535 3220 3230 3264 2036 3936  44 4552 202d 696
00001020: 6520 2020 2d69 6e66 6f72 6d20 4445 5220  e   -inform DER 
00001030: 2d69 6e0a 3030 3030 3033 6430 3a20 3230  -in.000003d0: 20
00001040: 3232 2032 3436 3320 3635 3732 2037 3432  22 2463 6572 742
00001050: 3220 3230 3264 2036 6536 6620 3666 3735  2 202d 6e6f 6f75
00001060: 2037 3432 3020 2020 2224 6365 7274 2220   7420   "$cert" 
00001070: 2d6e 6f6f 7574 200a 3030 3030 3033 6530  -noout .000003e0
00001080: 3a20 3264 3636 2036 3936 6520 3637 3635  : 2d66 696e 6765
00001090: 2037 3237 3020 3732 3639 2036 6537 3420   7270 7269 6e74 
000010a0: 3230 3264 2037 3336 3820 202d 6669 6e67  202d 7368  -fing
000010b0: 6572 7072 696e 7420 2d73 680a 3030 3030  erprint -sh.0000
000010c0: 3033 6630 3a20 3631 3331 2032 3033 3220  03f0: 6131 2032 
000010d0: 3365 3266 2036 3436 3520 3736 3266 2036  3e2f 6465 762f 6
000010e0: 6537 3520 3663 3663 2032 3037 6320 2061  e75 6c6c 207c  a
000010f0: 3120 323e 2f64 6576 2f6e 756c 6c20 7c0a  1 2>/dev/null |.
00001100: 3030 3030 3034 3030 3a20 3230 3733 2036  00000400: 2073 6
00001110: 3536 3420 3230 3237 2037 3332 6620 3565  564 2027 732f 5e
00001120: 3533 2034 3834 3120 3331 3230 2034 3636  53 4841 3120 466
00001130: 3920 2020 7365 6420 2773 2f5e 5348 4131  9   sed 's/^SHA1
00001140: 2046 690a 3030 3030 3034 3130 3a20 3665   Fi.00000410: 6e
00001150: 3637 2036 3537 3220 3730 3732 2036 3936  67 6572 7072 696
00001160: 6520 3734 3364 2032 6632 6620 3237 3230  e 743d 2f2f 2720
00001170: 2037 6332 3020 206e 6765 7270 7269 6e74   7c20  ngerprint
00001180: 3d2f 2f27 207c 200a 3030 3030 3034 3230  =//' | .00000420
00001190: 3a20 3734 3732 2032 3032 3720 3562 3361  : 7472 2027 5b3a
000011a0: 2036 6336 6620 3737 3635 2037 3233 6120   6c6f 7765 723a 
000011b0: 3564 3237 2032 3032 3720 2074 7220 275b  5d27 2027  tr '[
000011c0: 3a6c 6f77 6572 3a5d 2720 270a 3030 3030  :lower:]' '.0000
000011d0: 3034 3330 3a20 3562 3361 2037 3537 3020  0430: 5b3a 7570 
000011e0: 3730 3635 2037 3233 6120 3564 3237 2032  7065 723a 5d27 2
000011f0: 3933 6220 3362 3061 2032 3032 3020 205b  93b 3b0a 2020  [
00001200: 3a75 7070 6572 3a5d 2729 3b3b 2e20 200a  :upper:]');;.  .
00001210: 3030 3030 3034 3430 3a20 3230 3230 2032  00000440: 2020 2
00001220: 3032 3020 3230 3230 2036 3337 3220 3734  020 2020 6372 74
00001230: 3763 2037 3036 3520 3664 3239 2032 3036  7c 7065 6d29 206
00001240: 3620 2020 2020 2020 2063 7274 7c70 656d  6        crt|pem
00001250: 2920 660a 3030 3030 3034 3530 3a20 3730  ) f.00000450: 70
00001260: 3364 2032 3432 3820 3666 3730 2036 3536  3d 2428 6f70 656
00001270: 6520 3733 3733 2036 6332 3020 3738 3335  e 7373 6c20 7835
00001280: 2033 3033 3920 2070 3d24 286f 7065 6e73   3039  p=$(opens
00001290: 736c 2078 3530 390a 3030 3030 3034 3630  sl x509.00000460
000012a0: 3a20 3230 3264 2036 3936 6520 3230 3232  : 202d 696e 2022
000012b0: 2032 3436 3320 3635 3732 2037 3432 3220   2463 6572 7422 
000012c0: 3230 3264 2036 6536 6620 2020 2d69 6e20  202d 6e6f   -in 
000012d0: 2224 6365 7274 2220 2d6e 6f0a 3030 3030  "$cert" -no.0000
000012e0: 3034 3730 3a20 3666 3735 2037 3432 3020  0470: 6f75 7420 
000012f0: 3264 3636 2036 3936 6520 3637 3635 2037  2d66 696e 6765 7
00001300: 3237 3020 3732 3639 2036 6537 3420 206f  270 7269 6e74  o
00001310: 7574 202d 6669 6e67 6572 7072 696e 740a  ut -fingerprint.
00001320: 3030 3030 3034 3830 3a20 3230 3264 2037  00000480: 202d 7
00001330: 3336 3820 3631 3331 2032 3033 3220 3365  368 6131 2032 3e
00001340: 3266 2036 3436 3520 3736 3266 2036 6537  2f 6465 762f 6e7
00001350: 3520 2020 2d73 6861 3120 323e 2f64 6576  5   -sha1 2>/dev
00001360: 2f6e 750a 3030 3030 3034 3930 3a20 3663  /nu.00000490: 6c
00001370: 3663 2032 3037 6320 3230 3733 2036 3536  6c 207c 2073 656
00001380: 3420 3230 3237 2037 3332 6620 3565 3533  4 2027 732f 5e53
00001390: 2034 3834 3120 206c 6c20 7c20 7365 6420   4841  ll | sed 
000013a0: 2773 2f5e 5348 410a 3030 3030 3034 6130  's/^SHA.000004a0
000013b0: 3a20 3331 3230 2034 3636 3920 3665 3637  : 3120 4669 6e67
000013c0: 2036 3537 3220 3730 3732 2036 3936 6520   6572 7072 696e 
000013d0: 3734 3364 2032 6632 6620 2031 2046 696e  743d 2f2f  1 Fin
000013e0: 6765 7270 7269 6e74 3d2f 2f0a 3030 3030  gerprint=//.0000
000013f0: 3034 6230 3a20 3237 3230 2037 6332 3020  04b0: 2720 7c20 
00001400: 3734 3732 2032 3032 3720 3562 3361 2036  7472 2027 5b3a 6
00001410: 6336 6620 3737 3635 2037 3233 6120 2027  c6f 7765 723a  '
00001420: 207c 2074 7220 275b 3a6c 6f77 6572 3a0a   | tr '[:lower:.
00001430: 3030 3030 3034 6330 3a20 3564 3237 2032  000004c0: 5d27 2
00001440: 3032 3720 3562 3361 2037 3537 3020 3730  027 5b3a 7570 70
00001450: 3635 2037 3233 6120 3564 3237 2032 3933  65 723a 5d27 293
00001460: 6220 205d 2720 275b 3a75 7070 6572 3a5d  b  ]' '[:upper:]
00001470: 2729 3b0a 3030 3030 3034 6430 3a20 3362  ');.000004d0: 3b
00001480: 3061 2032 3032 3020 3230 3230 2032 3032  0a 2020 2020 202
00001490: 3020 3230 3230 2032 6132 3920 3230 3636  0 2020 2a29 2066
000014a0: 2037 3033 6420 203b 2e20 2020 2020 2020   703d  ;.       
000014b0: 202a 2920 6670 3d0a 3030 3030 3034 6530   *) fp=.000004e0
000014c0: 3a20 3232 3232 2033 6233 6220 3061 3230  : 2222 3b3b 0a20
000014d0: 2032 3032 3020 3230 3230 2032 3036 3520   2020 2020 2065 
000014e0: 3733 3631 2036 3330 6120 2022 223b 3b2e  7361 630a  "";;.
000014f0: 2020 2020 2020 6573 6163 2e0a 3030 3030        esac..0000
00001500: 3034 6630 3a20 3230 3230 2032 3032 3020  04f0: 2020 2020 
00001510: 3230 3230 2035 6232 3020 3264 3665 2032  2020 5b20 2d6e 2
00001520: 3032 3220 3234 3636 2037 3032 3220 2020  022 2466 7022   
00001530: 2020 2020 205b 202d 6e20 2224 6670 220a       [ -n "$fp".
00001540: 3030 3030 3035 3030 3a20 3230 3564 2032  00000500: 205d 2
00001550: 3037 6320 3763 3230 2036 3336 6620 3665  07c 7c20 636f 6e
00001560: 3734 2036 3936 6520 3735 3635 2030 6132  74 696e 7565 0a2
00001570: 3020 2020 5d20 7c7c 2063 6f6e 7469 6e75  0   ] || continu
00001580: 652e 200a 3030 3030 3035 3130 3a20 3230  e. .00000510: 20
00001590: 3230 2032 3032 3020 3230 3639 2036 3632  20 2020 2069 662
000015a0: 3020 3733 3735 2036 3436 6620 3230 3664  0 7375 646f 206d
000015b0: 2036 6636 6220 2020 2020 2020 6966 2073   6f6b       if s
000015c0: 7564 6f20 6d6f 6b0a 3030 3030 3035 3230  udo mok.00000520
000015d0: 3a20 3735 3734 2036 3936 6320 3230 3264  : 7574 696c 202d
000015e0: 2032 6436 6320 3639 3733 2037 3432 6420   2d6c 6973 742d 
000015f0: 3635 3665 2037 3236 6620 2075 7469 6c20  656e 726f  util 
00001600: 2d2d 6c69 7374 2d65 6e72 6f0a 3030 3030  --list-enro.0000
00001610: 3035 3330 3a20 3663 3663 2036 3536 3420  0530: 6c6c 6564 
00001620: 3230 3332 2033 6532 6620 3634 3635 2037  2032 3e2f 6465 7
00001630: 3632 6620 3665 3735 2036 6336 6320 206c  62f 6e75 6c6c  l
00001640: 6c65 6420 323e 2f64 6576 2f6e 756c 6c0a  led 2>/dev/null.
00001650: 3030 3030 3035 3430 3a20 3230 3763 2032  00000540: 207c 2
00001660: 3037 3420 3732 3230 2032 3735 6220 3361  074 7220 275b 3a
00001670: 3663 2036 6637 3720 3635 3732 2033 6135  6c 6f77 6572 3a5
00001680: 6420 2020 7c20 7472 2027 5b3a 6c6f 7765  d   | tr '[:lowe
00001690: 723a 5d0a 3030 3030 3035 3530 3a20 3237  r:].00000550: 27
000016a0: 3230 2032 3735 6220 3361 3735 2037 3037  20 275b 3a75 707
000016b0: 3020 3635 3732 2033 6135 6420 3237 3230  0 6572 3a5d 2720
000016c0: 2037 6332 3020 2027 2027 5b3a 7570 7065   7c20  ' '[:uppe
000016d0: 723a 5d27 207c 200a 3030 3030 3035 3630  r:]' | .00000560
000016e0: 3a20 3637 3732 2036 3537 3020 3230 3264  : 6772 6570 202d
000016f0: 2037 3132 3020 3232 3234 2036 3637 3020   7120 2224 6670 
00001700: 3232 3362 2032 3037 3420 2067 7265 7020  223b 2074  grep 
00001710: 2d71 2022 2466 7022 3b20 740a 3030 3030  -q "$fp"; t.0000
00001720: 3035 3730 3a20 3638 3635 2036 6530 6120  0570: 6865 6e0a 
00001730: 3230 3230 2032 3032 3020 3230 3230 2032  2020 2020 2020 2
00001740: 3032 3020 3635 3633 2036 3836 6620 2068  020 6563 686f  h
00001750: 656e 2e20 2020 2020 2020 2065 6368 6f0a  en.        echo.
00001760: 3030 3030 3035 3830 3a20 3230 3232 2032  00000580: 2022 2
00001770: 3436 3320 3635 3732 2037 3437 6320 3234  463 6572 747c 24
00001780: 3662 2036 3537 3920 3763 3539 2037 6332  6b 6579 7c59 7c2
00001790: 3420 2020 2224 6365 7274 7c24 6b65 797c  4   "$cert|$key|
000017a0: 597c 240a 3030 3030 3035 3930 3a20 3636  Y|$.00000590: 66
000017b0: 3730 2032 3230 6120 3230 3230 2032 3032  70 220a 2020 202
000017c0: 3020 3230 3230 2036 3536 6320 3733 3635  0 2020 656c 7365
000017d0: 2030 6132 3020 2066 7022 2e20 2020 2020   0a20  fp".     
000017e0: 2065 6c73 652e 200a 3030 3030 3035 6130   else. .000005a0
000017f0: 3a20 3230 3230 2032 3032 3020 3230 3230  : 2020 2020 2020
00001800: 2032 3036 3520 3633 3638 2036 6632 3020   2065 6368 6f20 
00001810: 3232 3234 2036 3336 3520 2020 2020 2020  2224 6365       
00001820: 2020 6563 686f 2022 2463 650a 3030 3030    echo "$ce.0000
00001830: 3035 6230 3a20 3732 3734 2037 6332 3420  05b0: 7274 7c24 
00001840: 3662 3635 2037 3937 6320 3465 3763 2032  6b65 797c 4e7c 2
00001850: 3436 3620 3730 3232 2030 6132 3020 2072  466 7022 0a20  r
00001860: 747c 246b 6579 7c4e 7c24 6670 222e 200a  t|$key|N|$fp". .
00001870: 3030 3030 3035 6330 3a20 3230 3230 2032  000005c0: 2020 2
00001880: 3032 3020 3230 3636 2036 3930 6120 3230  020 2066 690a 20
00001890: 3230 2032 3032 3020 3634 3666 2036 6536  20 2020 646f 6e6
000018a0: 3520 2020 2020 2020 6669 2e20 2020 2064  5       fi.    d
000018b0: 6f6e 650a 3030 3030 3035 6430 3a20 3061  one.000005d0: 0a
000018c0: 3230 2032 3037 6420 3061 3230 2032 3037  20 207d 0a20 207
000018d0: 3320 3633 3631 2036 6535 6620 3634 3639  3 6361 6e5f 6469
000018e0: 2037 3232 3020 202e 2020 7d2e 2020 7363   7220  .  }.  sc
000018f0: 616e 5f64 6972 200a 3030 3030 3035 6530  an_dir .000005e0
00001900: 3a20 3232 3234 2034 6434 6620 3462 3566  : 2224 4d4f 4b5f
00001910: 2034 3434 3920 3532 3232 2030 6132 3020   4449 5222 0a20 
00001920: 3230 3733 2036 3336 3120 2022 244d 4f4b  2073 6361  "$MOK
00001930: 5f44 4952 222e 2020 7363 610a 3030 3030  _DIR".  sca.0000
00001940: 3035 6630 3a20 3665 3566 2036 3436 3920  05f0: 6e5f 6469 
00001950: 3732 3230 2032 3232 3420 3463 3435 2034  7220 2224 4c45 4
00001960: 3734 3120 3433 3539 2035 6634 3420 206e  741 4359 5f44  n
00001970: 5f64 6972 2022 244c 4547 4143 595f 440a  _dir "$LEGACY_D.
00001980: 3030 3030 3036 3030 3a20 3439 3532 2032  00000600: 4952 2
00001990: 3230 6120 3764 3061 2030 6132 3320 3230  20a 7d0a 0a23 20
000019a0: 3439 2036 3632 3020 3635 3665 2037 3632  49 6620 656e 762
000019b0: 3020 2049 5222 2e7d 2e2e 2320 4966 2065  0  IR".}..# If e
000019c0: 6e76 200a 3030 3030 3036 3130 3a20 3639  nv .00000610: 69
000019d0: 3733 2032 3036 3120 3663 3732 2036 3536  73 2061 6c72 656
000019e0: 3120 3634 3739 2032 3037 3320 3635 3734  1 6479 2073 6574
000019f0: 2032 3036 3120 2069 7320 616c 7265 6164   2061  is alread
00001a00: 7920 7365 7420 610a 3030 3030 3036 3230  y set a.00000620
00001a10: 3a20 3665 3634 2032 3037 3620 3631 3663  : 6e64 2076 616c
00001a20: 2036 3936 3420 3263 3230 2036 6137 3520   6964 2c20 6a75 
00001a30: 3733 3734 2032 3036 3520 206e 6420 7661  7374 2065  nd va
00001a40: 6c69 642c 206a 7573 7420 650a 3030 3030  lid, just e.0000
00001a50: 3036 3330 3a20 3633 3638 2036 6632 3020  0630: 6368 6f20 
00001a60: 3635 3738 2037 3036 6620 3732 3734 2037  6578 706f 7274 7
00001a70: 3332 3020 3631 3665 2036 3432 3020 2063  320 616e 6420  c
00001a80: 686f 2065 7870 6f72 7473 2061 6e64 200a  ho exports and .
00001a90: 3030 3030 3036 3430 3a20 3635 3738 2036  00000640: 6578 6
00001aa0: 3937 3420 3230 3330 2030 6136 3920 3636  974 2030 0a69 66
00001ab0: 3230 2035 6232 3020 3264 3665 2032 3032  20 5b20 2d6e 202
00001ac0: 3220 2065 7869 7420 302e 6966 205b 202d  2  exit 0.if [ -
00001ad0: 6e20 220a 3030 3030 3036 3530 3a20 3234  n ".00000650: 24
00001ae0: 3762 2034 6234 6420 3466 3434 2035 6634  7b 4b4d 4f44 5f4
00001af0: 3320 3435 3532 2035 3433 6120 3264 3764  3 4552 543a 2d7d
00001b00: 2032 3232 3020 2024 7b4b 4d4f 445f 4345   2220  ${KMOD_CE
00001b10: 5254 3a2d 7d22 200a 3030 3030 3036 3630  RT:-}" .00000660
00001b20: 3a20 3564 3230 2032 3632 3620 3230 3562  : 5d20 2626 205b
00001b30: 2032 3032 6420 3665 3230 2032 3232 3420   202d 6e20 2224 
00001b40: 3762 3462 2034 6434 6620 205d 2026 2620  7b4b 4d4f  ] && 
00001b50: 5b20 2d6e 2022 247b 4b4d 4f0a 3030 3030  [ -n "${KMO.0000
00001b60: 3036 3730 3a20 3434 3566 2034 6234 3520  0670: 445f 4b45 
00001b70: 3539 3361 2032 6437 6420 3232 3230 2035  593a 2d7d 2220 5
00001b80: 6432 3020 3236 3236 2032 3035 6220 2044  d20 2626 205b  D
00001b90: 5f4b 4559 3a2d 7d22 205d 2026 2620 5b0a  _KEY:-}" ] && [.
00001ba0: 3030 3030 3036 3830 3a20 3230 3264 2036  00000680: 202d 6
00001bb0: 3632 3020 3232 3234 2034 6234 6420 3466  620 2224 4b4d 4f
00001bc0: 3434 2035 6634 3320 3435 3532 2035 3432  44 5f43 4552 542
00001bd0: 3220 2020 2d66 2022 244b 4d4f 445f 4345  2   -f "$KMOD_CE
00001be0: 5254 220a 3030 3030 3036 3930 3a20 3230  RT".00000690: 20
00001bf0: 3564 2032 3032 3620 3236 3230 2035 6232  5d 2026 2620 5b2
00001c00: 3020 3264 3636 2032 3032 3220 3234 3462  0 2d66 2022 244b
00001c10: 2034 6434 6620 2020 5d20 2626 205b 202d   4d4f   ] && [ -
00001c20: 6620 2224 4b4d 4f0a 3030 3030 3036 6130  f "$KMO.000006a0
00001c30: 3a20 3434 3566 2034 6234 3520 3539 3232  : 445f 4b45 5922
00001c40: 2032 3035 6420 3362 3230 2037 3436 3820   205d 3b20 7468 
00001c50: 3635 3665 2030 6132 3020 2044 5f4b 4559  656e 0a20  D_KEY
00001c60: 2220 5d3b 2074 6865 6e2e 200a 3030 3030  " ]; then. .0000
00001c70: 3036 6230 3a20 3230 3635 2036 3336 3820  06b0: 2065 6368 
00001c80: 3666 3230 2032 3236 3520 3738 3730 2036  6f20 2265 7870 6
00001c90: 6637 3220 3734 3230 2034 6234 6420 2020  f72 7420 4b4d   
00001ca0: 6563 686f 2022 6578 706f 7274 204b 4d0a  echo "export KM.
00001cb0: 3030 3030 3036 6330 3a20 3466 3434 2035  000006c0: 4f44 5
00001cc0: 6634 3320 3435 3532 2035 3433 6420 3234  f43 4552 543d 24
00001cd0: 3462 2034 6434 6620 3434 3566 2034 3334  4b 4d4f 445f 434
00001ce0: 3520 204f 445f 4345 5254 3d24 4b4d 4f44  5  OD_CERT=$KMOD
00001cf0: 5f43 450a 3030 3030 3036 6430 3a20 3532  _CE.000006d0: 52
00001d00: 3534 2032 3230 6120 3230 3230 2036 3536  54 220a 2020 656
00001d10: 3320 3638 3666 2032 3032 3220 3635 3738  3 686f 2022 6578
00001d20: 2037 3036 6620 2052 5422 2e20 2065 6368   706f  RT".  ech
00001d30: 6f20 2265 7870 6f0a 3030 3030 3036 6530  o "expo.000006e0
00001d40: 3a20 3732 3734 2032 3034 6220 3464 3466  : 7274 204b 4d4f
00001d50: 2034 3435 6620 3462 3435 2035 3933 6420   445f 4b45 593d 
00001d60: 3234 3462 2034 6434 6620 2072 7420 4b4d  244b 4d4f  rt KM
00001d70: 4f44 5f4b 4559 3d24 4b4d 4f0a 3030 3030  OD_KEY=$KMO.0000
00001d80: 3036 6630 3a20 3434 3566 2034 6234 3520  06f0: 445f 4b45 
00001d90: 3539 3232 2030 6132 3020 3230 3635 2037  5922 0a20 2065 7
00001da0: 3836 3920 3734 3230 2033 3030 6120 2044  869 7420 300a  D
00001db0: 5f4b 4559 222e 2020 6578 6974 2030 2e0a  _KEY".  exit 0..
00001dc0: 3030 3030 3037 3030 3a20 3636 3639 2030  00000700: 6669 0
00001dd0: 6130 6120 3233 3230 2034 3237 3520 3639  a0a 2320 4275 69
00001de0: 3663 2036 3432 3020 3631 3230 2036 6336  6c 6420 6120 6c6
00001df0: 3920 2066 692e 2e23 2042 7569 6c64 2061  9  fi..# Build a
00001e00: 206c 690a 3030 3030 3037 3130 3a20 3733   li.00000710: 73
00001e10: 3734 2030 6136 6420 3631 3730 2036 3636  74 0a6d 6170 666
00001e20: 3920 3663 3635 2032 3032 6420 3734 3230  9 6c65 202d 7420
00001e30: 2034 3935 3420 2073 742e 6d61 7066 696c   4954  st.mapfil
00001e40: 6520 2d74 2049 540a 3030 3030 3037 3230  e -t IT.00000720
00001e50: 3a20 3435 3464 2035 3332 3020 3363 3230  : 454d 5320 3c20
00001e60: 2033 6332 3820 3663 3639 2037 3337 3420   3c28 6c69 7374 
00001e70: 3566 3730 2036 3136 3920 2045 4d53 203c  5f70 6169  EMS <
00001e80: 203c 286c 6973 745f 7061 690a 3030 3030   <(list_pai.0000
00001e90: 3037 3330 3a20 3732 3733 2032 3930 6120  0730: 7273 290a 
00001ea0: 3639 3636 2032 3035 6220 3230 3232 2032  6966 205b 2022 2
00001eb0: 3437 6220 3233 3439 2035 3434 3520 2072  47b 2349 5445  r
00001ec0: 7329 2e69 6620 5b20 2224 7b23 4954 450a  s).if [ "${#ITE.
00001ed0: 3030 3030 3037 3430 3a20 3464 3533 2035  00000740: 4d53 5
00001ee0: 6234 3020 3564 3764 2032 3232 3020 3264  b40 5d7d 2220 2d
00001ef0: 3635 2037 3132 3020 3330 3230 2035 6433  65 7120 3020 5d3
00001f00: 6220 204d 535b 405d 7d22 202d 6571 2030  b  MS[@]}" -eq 0
00001f10: 205d 3b0a 3030 3030 3037 3530 3a20 3230   ];.00000750: 20
00001f20: 3734 2036 3836 3520 3665 3061 2032 3032  74 6865 6e0a 202
00001f30: 3020 3635 3633 2036 3836 6620 3230 3232  0 6563 686f 2022
00001f40: 2034 6536 6620 2020 7468 656e 2e20 2065   4e6f   then.  e
00001f50: 6368 6f20 224e 6f0a 3030 3030 3037 3630  cho "No.00000760
00001f60: 3a20 3230 3464 2034 6634 6220 3230 3633  : 204d 4f4b 2063
00001f70: 2036 3537 3220 3734 3262 2036 6236 3520   6572 742b 6b65 
00001f80: 3739 3230 2037 3036 3120 2020 4d4f 4b20  7920 7061   MOK 
00001f90: 6365 7274 2b6b 6579 2070 610a 3030 3030  cert+key pa.0000
00001fa0: 3037 3730 3a20 3639 3732 2037 3332 3020  0770: 6972 7320 
00001fb0: 3636 3666 2037 3536 6520 3634 3230 2037  666f 756e 6420 7
00001fc0: 3536 6520 3634 3635 2037 3232 3020 2069  56e 6465 7220  i
00001fd0: 7273 2066 6f75 6e64 2075 6e64 6572 200a  rs found under .
00001fe0: 3030 3030 3037 3830 3a20 3234 3464 2034  00000780: 244d 4
00001ff0: 6634 6220 3566 3434 2034 3935 3220 3230  f4b 5f44 4952 20
00002000: 3666 2037 3232 3020 3234 3463 2034 3534  6f 7220 244c 454
00002010: 3720 2024 4d4f 4b5f 4449 5220 6f72 2024  7  $MOK_DIR or $
00002020: 4c45 470a 3030 3030 3037 3930 3a20 3431  LEG.00000790: 41
00002030: 3433 2035 3935 6620 3434 3439 2035 3232  43 595f 4449 522
00002040: 3220 3230 3365 2032 3633 3220 3061 3230  2 203e 2632 0a20
00002050: 2032 3036 3520 2041 4359 5f44 4952 2220   2065  ACY_DIR" 
00002060: 3e26 322e 2020 650a 3030 3030 3037 6130  >&2.  e.000007a0
00002070: 3a20 3738 3639 2037 3432 3020 3331 3061  : 7869 7420 310a
00002080: 2036 3636 3920 3061 3061 2032 3332 3020   6669 0a0a 2320 
00002090: 3530 3732 2036 3536 3620 2078 6974 2031  5072 6566  xit 1
000020a0: 2e66 692e 2e23 2050 7265 660a 3030 3030  .fi..# Pref.0000
000020b0: 3037 6230 3a20 3635 3732 2032 3037 3420  07b0: 6572 2074 
000020c0: 3638 3635 2032 3036 3620 3639 3732 2037  6865 2066 6972 7
000020d0: 3337 3420 3230 3635 2036 6537 3220 2065  374 2065 6e72  e
000020e0: 7220 7468 6520 6669 7273 7420 656e 720a  r the first enr.
000020f0: 3030 3030 3037 6330 3a20 3666 3663 2036  000007c0: 6f6c 6
00002100: 6336 3520 3634 3230 2037 3036 3120 3639  c65 6420 7061 69
00002110: 3732 2032 3036 3920 3636 3230 2036 6536  72 2069 6620 6e6
00002120: 6620 206f 6c6c 6564 2070 6169 7220 6966  f  olled pair if
00002130: 206e 6f0a 3030 3030 3037 6430 3a20 3665   no.000007d0: 6e
00002140: 3264 2036 3936 6520 3734 3635 2037 3236  2d 696e 7465 726
00002150: 3120 3633 3734 2036 3937 3620 3635 3061  1 6374 6976 650a
00002160: 2036 3636 6620 206e 2d69 6e74 6572 6163   666f  n-interac
00002170: 7469 7665 2e66 6f0a 3030 3030 3037 6530  tive.fo.000007e0
00002180: 3a20 3732 3230 2036 6336 3920 3665 3635  : 7220 6c69 6e65
00002190: 2032 3036 3920 3665 3230 2032 3232 3420   2069 6e20 2224 
000021a0: 3762 3439 2035 3434 3520 2072 206c 696e  7b49 5445  r lin
000021b0: 6520 696e 2022 247b 4954 450a 3030 3030  e in "${ITE.0000
000021c0: 3037 6630 3a20 3464 3533 2035 6234 3020  07f0: 4d53 5b40 
000021d0: 3564 3764 2032 3233 6220 3230 3634 2036  5d7d 223b 2064 6
000021e0: 6630 6120 3230 3230 2034 3934 3620 204d  f0a 2020 4946  M
000021f0: 535b 405d 7d22 3b20 646f 2e20 2049 460a  S[@]}"; do.  IF.
00002200: 3030 3030 3038 3030 3a20 3533 3364 2032  00000800: 533d 2
00002210: 3737 6320 3237 3230 2037 3236 3520 3631  77c 2720 7265 61
00002220: 3634 2032 3032 6420 3732 3230 2036 3336  64 202d 7220 636
00002230: 3520 2053 3d27 7c27 2072 6561 6420 2d72  5  S='|' read -r
00002240: 2063 650a 3030 3030 3038 3130 3a20 3732   ce.00000810: 72
00002250: 3734 2032 3036 6220 3635 3739 2032 3036  74 206b 6579 206
00002260: 3520 3665 3732 2036 6636 6320 3663 3635  5 6e72 6f6c 6c65
00002270: 2036 3432 3020 2072 7420 6b65 7920 656e   6420  rt key en
00002280: 726f 6c6c 6564 200a 3030 3030 3038 3230  rolled .00000820
00002290: 3a20 3636 3730 2032 3033 6320 3363 3363  : 6670 203c 3c3c
000022a0: 2032 3232 3420 3663 3639 2036 6536 3520   2224 6c69 6e65 
000022b0: 3232 3061 2032 3032 3020 2066 7020 3c3c  220a 2020  fp <<
000022c0: 3c22 246c 696e 6522 2e20 200a 3030 3030  <"$line".  .0000
000022d0: 3038 3330 3a20 3639 3636 2032 3035 6220  0830: 6966 205b 
000022e0: 3230 3232 2032 3436 3520 3665 3732 2036  2022 2465 6e72 6
000022f0: 6636 6320 3663 3635 2036 3432 3220 2069  f6c 6c65 6422  i
00002300: 6620 5b20 2224 656e 726f 6c6c 6564 220a  f [ "$enrolled".
00002310: 3030 3030 3038 3430 3a20 3230 3364 2032  00000840: 203d 2
00002320: 3032 3220 3539 3232 2032 3035 6420 3362  022 5922 205d 3b
00002330: 3230 2037 3436 3820 3635 3665 2030 6132  20 7468 656e 0a2
00002340: 3020 2020 3d20 2259 2220 5d3b 2074 6865  0   = "Y" ]; the
00002350: 6e2e 200a 3030 3030 3038 3530 3a20 3230  n. .00000850: 20
00002360: 3230 2032 3036 3520 3633 3638 2036 6632  20 2065 6368 6f2
00002370: 3020 3232 3635 2037 3837 3020 3666 3732  0 2265 7870 6f72
00002380: 2037 3432 3020 2020 2020 6563 686f 2022   7420     echo "
00002390: 6578 706f 7274 200a 3030 3030 3038 3630  export .00000860
000023a0: 3a20 3462 3464 2034 6634 3420 3566 3433  : 4b4d 4f44 5f43
000023b0: 2034 3535 3220 3534 3364 2032 3436 3320   4552 543d 2463 
000023c0: 3635 3732 2037 3432 3220 204b 4d4f 445f  6572 7422  KMOD_
000023d0: 4345 5254 3d24 6365 7274 220a 3030 3030  CERT=$cert".0000
000023e0: 3038 3730 3a20 3061 3230 2032 3032 3020  0870: 0a20 2020 
000023f0: 3230 3635 2036 3336 3820 3666 3230 2032  2065 6368 6f20 2
00002400: 3236 3520 3738 3730 2036 6637 3220 202e  265 7870 6f72  .
00002410: 2020 2020 6563 686f 2022 6578 706f 720a      echo "expor.
00002420: 3030 3030 3038 3830 3a20 3734 3230 2034  00000880: 7420 4
00002430: 6234 6420 3466 3434 2035 6634 6220 3435  b4d 4f44 5f4b 45
00002440: 3539 2033 6432 3420 3662 3635 2037 3932  59 3d24 6b65 792
00002450: 3220 2074 204b 4d4f 445f 4b45 593d 246b  2  t KMOD_KEY=$k
00002460: 6579 220a 3030 3030 3038 3930 3a20 3061  ey".00000890: 0a
00002470: 3230 2032 3032 3020 3230 3635 2037 3836  20 2020 2065 786
00002480: 3920 3734 3230 2033 3030 6120 3230 3230  9 7420 300a 2020
00002490: 2036 3636 3920 202e 2020 2020 6578 6974   6669  .    exit
000024a0: 2030 2e20 2066 690a 3030 3030 3038 6130   0.  fi.000008a0
000024b0: 3a20 3061 3634 2036 6636 6520 3635 3061  : 0a64 6f6e 650a
000024c0: 2030 6132 3320 3230 3439 2036 3632 3020   0a23 2049 6620 
000024d0: 3665 3666 2036 6536 3520 202e 646f 6e65  6e6f 6e65  .done
000024e0: 2e2e 2320 4966 206e 6f6e 650a 3030 3030  ..# If none.0000
000024f0: 3038 6230 3a20 3230 3635 2036 6537 3220  08b0: 2065 6e72 
00002500: 3666 3663 2036 6336 3520 3634 3263 2032  6f6c 6c65 642c 2
00002510: 3036 3620 3631 3663 2036 6332 3020 2020  066 616c 6c20   
00002520: 656e 726f 6c6c 6564 2c20 6661 6c6c 200a  enrolled, fall .
00002530: 3030 3030 3038 6330 3a20 3632 3631 2036  000008c0: 6261 6
00002540: 3336 6220 3230 3734 2036 6632 3020 3636  36b 2074 6f20 66
00002550: 3639 2037 3237 3320 3734 3230 2037 3036  69 7273 7420 706
00002560: 3120 2062 6163 6b20 746f 2066 6972 7374  1  back to first
00002570: 2070 610a 3030 3030 3038 6430 3a20 3639   pa.000008d0: 69
00002580: 3732 2032 3036 3120 3665 3634 2032 3037  72 2061 6e64 207
00002590: 3720 3631 3732 2036 6530 6120 3439 3436  7 6172 6e0a 4946
000025a0: 2035 3333 6420 2069 7220 616e 6420 7761   533d  ir and wa
000025b0: 726e 2e49 4653 3d0a 3030 3030 3038 6530  rn.IFS=.000008e0
000025c0: 3a20 3237 3763 2032 3732 3020 3732 3635  : 277c 2720 7265
000025d0: 2036 3136 3420 3230 3264 2037 3232 3020   6164 202d 7220 
000025e0: 3633 3635 2037 3237 3420 2027 7c27 2072  6365 7274  '|' r
000025f0: 6561 6420 2d72 2063 6572 740a 3030 3030  ead -r cert.0000
00002600: 3038 6630 3a20 3230 3662 2036 3537 3920  08f0: 206b 6579 
00002610: 3230 3635 2036 6537 3220 3666 3663 2036  2065 6e72 6f6c 6
00002620: 6336 3520 3634 3230 2036 3637 3020 2020  c65 6420 6670   
00002630: 6b65 7920 656e 726f 6c6c 6564 2066 700a  key enrolled fp.
00002640: 3030 3030 3039 3030 3a20 3230 3363 2033  00000900: 203c 3
00002650: 6333 6320 3232 3234 2037 6234 3920 3534  c3c 2224 7b49 54
00002660: 3435 2034 6435 3320 3562 3330 2035 6437  45 4d53 5b30 5d7
00002670: 6420 2020 3c3c 3c22 247b 4954 454d 535b  d   <<<"${ITEMS[
00002680: 305d 7d0a 3030 3030 3039 3130 3a20 3232  0]}.00000910: 22
00002690: 3061 2036 3536 3320 3638 3666 2032 3032  0a 6563 686f 202
000026a0: 3220 3537 3631 2037 3236 6520 3639 3665  2 5761 726e 696e
000026b0: 2036 3733 6120 2022 2e65 6368 6f20 2257   673a  ".echo "W
000026c0: 6172 6e69 6e67 3a0a 3030 3030 3039 3230  arning:.00000920
000026d0: 3a20 3230 3733 2036 3536 6320 3635 3633  : 2073 656c 6563
000026e0: 2037 3436 3520 3634 3230 2036 3336 3520   7465 6420 6365 
000026f0: 3732 3734 2032 3036 3920 2020 7365 6c65  7274 2069   sele
00002700: 6374 6564 2063 6572 7420 690a 3030 3030  cted cert i.0000
00002710: 3039 3330 3a20 3733 3230 2036 6536 6620  0930: 7320 6e6f 
00002720: 3734 3230 2036 3536 6520 3732 3666 2036  7420 656e 726f 6
00002730: 6336 6320 3635 3634 2032 3032 3820 2073  c6c 6564 2028  s
00002740: 206e 6f74 2065 6e72 6f6c 6c65 6420 280a   not enrolled (.
00002750: 3030 3030 3039 3430 3a20 3533 3438 2034  00000940: 5348 4
00002760: 3133 3120 3364 3234 2036 3637 3020 3239  131 3d24 6670 29
00002770: 3265 2032 3034 6220 3635 3732 2036 6536  2e 204b 6572 6e6
00002780: 3520 2053 4841 313d 2466 7029 2e20 4b65  5  SHA1=$fp). Ke
00002790: 726e 650a 3030 3030 3039 3530 3a20 3663  rne.00000950: 6c
000027a0: 3230 2036 6436 3120 3739 3230 2037 3236  20 6d61 7920 726
000027b0: 3520 3661 3635 2036 3337 3420 3230 3733  5 6a65 6374 2073
000027c0: 2036 3936 3720 206c 206d 6179 2072 656a   6967  l may rej
000027d0: 6563 7420 7369 670a 3030 3030 3039 3630  ect sig.00000960
000027e0: 3a20 3665 3635 2036 3432 3020 3664 3666  : 6e65 6420 6d6f
000027f0: 2036 3437 3520 3663 3635 2037 3332 6520   6475 6c65 732e 
00002800: 3232 3230 2033 6532 3620 206e 6564 206d  2220 3e26  ned m
00002810: 6f64 756c 6573 2e22 203e 260a 3030 3030  odules." >&.0000
00002820: 3039 3730 3a20 3332 3061 2036 3536 3320  0970: 320a 6563 
00002830: 3638 3666 2032 3032 3220 3635 3738 2037  686f 2022 6578 7
00002840: 3036 6620 3732 3734 2032 3034 6220 2032  06f 7274 204b  2
00002850: 2e65 6368 6f20 2265 7870 6f72 7420 4b0a  .echo "export K.
00002860: 3030 3030 3039 3830 3a20 3464 3466 2034  00000980: 4d4f 4
00002870: 3435 6620 3433 3435 2035 3235 3420 3364  45f 4345 5254 3d
00002880: 3234 2036 3336 3520 3732 3734 2032 3230  24 6365 7274 220
00002890: 6120 204d 4f44 5f43 4552 543d 2463 6572  a  MOD_CERT=$cer
000028a0: 7422 2e0a 3030 3030 3039 3930 3a20 3635  t"..00000990: 65
000028b0: 3633 2036 3836 6620 3230 3232 2036 3537  63 686f 2022 657
000028c0: 3820 3730 3666 2037 3237 3420 3230 3462  8 706f 7274 204b
000028d0: 2034 6434 6620 2065 6368 6f20 2265 7870   4d4f  echo "exp
000028e0: 6f72 7420 4b4d 4f0a 3030 3030 3039 6130  ort KMO.000009a0
000028f0: 3a20 3434 3566 2034 6234 3520 3539 3364  : 445f 4b45 593d
00002900: 2032 3436 6220 3635 3739 2032 3230 6120   246b 6579 220a 
00002910: 2020 2020 2020 2020 2020 2044 5f4b 4559             D_KEY
00002920: 3d24 6b65 7922 2e0a                      =$key"..
