00000000: 3030 3030 3030 3030 3a20 3233 3231 2032  00000000: 2321 2
00000010: 6637 3520 3733 3732 2032 6636 3220 3639  f75 7372 2f62 69
00000020: 3665 2032 6636 3520 3665 3736 2032 3036  6e 2f65 6e76 206
00000030: 3220 2023 212f 7573 722f 6269 6e2f 656e  2  #!/usr/bin/en
00000040: 7620 620a 3030 3030 3030 3130 3a20 3631  v b.00000010: 61
00000050: 3733 2036 3830 6120 3233 3230 2034 3436  73 680a 2320 446
00000060: 3520 3733 3633 2037 3236 3920 3730 3734  5 7363 7269 7074
00000070: 2036 3936 6620 2061 7368 2e23 2044 6573   696f  ash.# Des
00000080: 6372 6970 7469 6f0a 3030 3030 3030 3230  criptio.00000020
00000090: 3a20 3665 3361 2032 3035 3620 3631 3663  : 6e3a 2056 616c
000000a0: 2036 3936 3420 3631 3734 2036 3537 3320   6964 6174 6573 
000000b0: 3230 3734 2036 3836 3520 206e 3a20 5661  2074 6865  n: Va
000000c0: 6c69 6461 7465 7320 7468 650a 3030 3030  lidates the.0000
000000d0: 3030 3330 3a20 3230 3730 2037 3236 3520  0030: 2070 7265 
000000e0: 3733 3635 2036 6536 3320 3635 3230 2036  7365 6e63 6520 6
000000f0: 6636 3620 3230 3533 2036 3536 3320 2020  f66 2053 6563   
00000100: 7072 6573 656e 6365 206f 6620 5365 630a  presence of Sec.
00000110: 3030 3030 3030 3430 3a20 3735 3732 2036  00000040: 7572 6
00000120: 3532 3020 3432 3666 2036 6637 3420 3230  520 426f 6f74 20
00000130: 3431 2035 3535 3420 3438 3230 2036 3236  41 5554 4820 626
00000140: 6320 2075 7265 2042 6f6f 7420 4155 5448  c  ure Boot AUTH
00000150: 2062 6c0a 3030 3030 3030 3530 3a20 3666   bl.00000050: 6f
00000160: 3632 2037 3332 6520 3061 3061 2037 3336  62 732e 0a0a 736
00000170: 3520 3734 3230 2032 6436 3520 3735 3666  5 7420 2d65 756f
00000180: 2032 3037 3020 206f 6273 2e2e 2e73 6574   2070  obs...set
00000190: 202d 6575 6f20 700a 3030 3030 3030 3630   -euo p.00000060
000001a0: 3a20 3639 3730 2036 3536 3620 3631 3639  : 6970 6566 6169
000001b0: 2036 6330 6120 3061 3533 2035 3234 3320   6c0a 0a53 5243 
000001c0: 3566 3434 2034 3935 3220 2069 7065 6661  5f44 4952  ipefa
000001d0: 696c 2e2e 5352 435f 4449 520a 3030 3030  il..SRC_DIR.0000
000001e0: 3030 3730 3a20 3364 3232 2032 3230 6120  0070: 3d22 220a 
000001f0: 3639 3636 2032 3035 6220 3230 3264 2036  6966 205b 202d 6
00000200: 3632 3020 3666 3735 2037 3432 6620 203d  620 6f75 742f  =
00000210: 2222 2e69 6620 5b20 2d66 206f 7574 2f0a  "".if [ -f out/.
00000220: 3030 3030 3030 3830 3a20 3733 3635 2036  00000080: 7365 6
00000230: 3337 3520 3732 3635 2037 3636 3120 3732  375 7265 7661 72
00000240: 3733 2032 6635 3020 3462 3265 2036 3137  73 2f50 4b2e 617
00000250: 3520 2073 6563 7572 6576 6172 732f 504b  5  securevars/PK
00000260: 2e61 750a 3030 3030 3030 3930 3a20 3734  .au.00000090: 74
00000270: 3638 2032 3035 6420 3230 3236 2032 3632  68 205d 2026 262
00000280: 3020 3562 3230 2032 6436 3620 3230 3666  0 5b20 2d66 206f
00000290: 2037 3537 3420 2074 6820 5d20 2626 205b   7574  th ] && [
000002a0: 202d 6620 6f75 740a 3030 3030 3030 6130   -f out.000000a0
000002b0: 3a20 3266 3733 2036 3536 3320 3735 3732  : 2f73 6563 7572
000002c0: 2036 3537 3620 3631 3732 2037 3332 6620   6576 6172 732f 
000002d0: 3462 3435 2034 6232 6520 202f 7365 6375  4b45 4b2e  /secu
000002e0: 7265 7661 7273 2f4b 454b 2e0a 3030 3030  revars/KEK..0000
000002f0: 3030 6230 3a20 3631 3735 2037 3436 3820  00b0: 6175 7468 
00000300: 3230 3564 2032 3032 3620 3236 3230 2035  205d 2026 2620 5
00000310: 6232 3020 3264 3636 2032 3036 6620 2061  b20 2d66 206f  a
00000320: 7574 6820 5d20 2626 205b 202d 6620 6f0a  uth ] && [ -f o.
00000330: 3030 3030 3030 6330 3a20 3735 3734 2032  000000c0: 7574 2
00000340: 6637 3320 3635 3633 2037 3537 3220 3635  f73 6563 7572 65
00000350: 3736 2036 3137 3220 3733 3266 2036 3436  76 6172 732f 646
00000360: 3220 2075 742f 7365 6375 7265 7661 7273  2  ut/securevars
00000370: 2f64 620a 3030 3030 3030 6430 3a20 3265  /db.000000d0: 2e
00000380: 3631 2037 3537 3420 3638 3230 2035 6433  61 7574 6820 5d3
00000390: 6220 3230 3734 2036 3836 3520 3665 3061  b 2074 6865 6e0a
000003a0: 2032 3032 3020 202e 6175 7468 205d 3b20   2020  .auth ]; 
000003b0: 7468 656e 2e20 200a 3030 3030 3030 6530  then.  .000000e0
000003c0: 3a20 3230 3230 2035 3335 3220 3433 3566  : 2020 5352 435f
000003d0: 2034 3434 3920 3532 3364 2032 3236 6620   4449 523d 226f 
000003e0: 3735 3734 2032 6637 3320 2020 2053 5243  7574 2f73    SRC
000003f0: 5f44 4952 3d22 6f75 742f 730a 3030 3030  _DIR="out/s.0000
00000400: 3030 6630 3a20 3635 3633 2037 3537 3220  00f0: 6563 7572 
00000410: 3635 3736 2036 3137 3220 3733 3232 2030  6576 6172 7322 0
00000420: 6136 3520 3663 3639 2036 3632 3020 2065  a65 6c69 6620  e
00000430: 6375 7265 7661 7273 222e 656c 6966 200a  curevars".elif .
00000440: 3030 3030 3031 3030 3a20 3562 3230 2032  00000100: 5b20 2
00000450: 6436 3620 3230 3733 2036 3536 3320 3735  d66 2073 6563 75
00000460: 3732 2036 3536 3220 3666 3666 2037 3435  72 6562 6f6f 745
00000470: 6620 205b 202d 6620 7365 6375 7265 626f  f  [ -f securebo
00000480: 6f74 5f0a 3030 3030 3031 3130 3a20 3633  ot_.00000110: 63
00000490: 3635 2037 3237 3420 3733 3266 2035 3034  65 7274 732f 504
000004a0: 6220 3265 3631 2037 3537 3420 3638 3230  b 2e61 7574 6820
000004b0: 2035 6432 3020 2063 6572 7473 2f50 4b2e   5d20  certs/PK.
000004c0: 6175 7468 205d 200a 3030 3030 3031 3230  auth ] .00000120
000004d0: 3a20 3236 3236 2032 3035 6220 3230 3264  : 2626 205b 202d
000004e0: 2036 3632 3020 3733 3635 2036 3337 3520   6620 7365 6375 
000004f0: 3732 3635 2036 3236 6620 2026 2620 5b20  7265 626f  && [ 
00000500: 2d66 2073 6563 7572 6562 6f0a 3030 3030  -f securebo.0000
00000510: 3031 3330 3a20 3666 3734 2035 6636 3320  0130: 6f74 5f63 
00000520: 3635 3732 2037 3437 3320 3266 3462 2034  6572 7473 2f4b 4
00000530: 3534 6220 3265 3631 2037 3537 3420 206f  54b 2e61 7574  o
00000540: 745f 6365 7274 732f 4b45 4b2e 6175 740a  t_certs/KEK.aut.
00000550: 3030 3030 3031 3430 3a20 3638 3230 2035  00000140: 6820 5
00000560: 6432 3020 3236 3236 2032 3035 6220 3230  d20 2626 205b 20
00000570: 3264 2036 3632 3020 3733 3635 2036 3337  2d 6620 7365 637
00000580: 3520 2068 205d 2026 2620 5b20 2d66 2073  5  h ] && [ -f s
00000590: 6563 750a 3030 3030 3031 3530 3a20 3732  ecu.00000150: 72
000005a0: 3635 2036 3236 6620 3666 3734 2035 6636  65 626f 6f74 5f6
000005b0: 3320 3635 3732 2037 3437 3320 3266 3634  3 6572 7473 2f64
000005c0: 2036 3232 6520 2072 6562 6f6f 745f 6365   622e  reboot_ce
000005d0: 7274 732f 6462 2e0a 3030 3030 3031 3630  rts/db..00000160
000005e0: 3a20 3631 3735 2037 3436 3820 3230 3564  : 6175 7468 205d
000005f0: 2033 6232 3020 3734 3638 2036 3536 6520   3b20 7468 656e 
00000600: 3061 3230 2032 3032 3020 2061 7574 6820  0a20 2020  auth 
00000610: 5d3b 2074 6865 6e2e 2020 200a 3030 3030  ]; then.   .0000
00000620: 3031 3730 3a20 3230 3533 2035 3234 3320  0170: 2053 5243 
00000630: 3566 3434 2034 3935 3220 3364 3232 2037  5f44 4952 3d22 7
00000640: 3336 3520 3633 3735 2037 3236 3520 2020  365 6375 7265   
00000650: 5352 435f 4449 523d 2273 6563 7572 650a  SRC_DIR="secure.
00000660: 3030 3030 3031 3830 3a20 3632 3666 2036  00000180: 626f 6
00000670: 6637 3420 3566 3633 2036 3537 3220 3734  f74 5f63 6572 74
00000680: 3733 2032 3230 6120 3635 3663 2037 3336  73 220a 656c 736
00000690: 3520 2062 6f6f 745f 6365 7274 7322 2e65  5  boot_certs".e
000006a0: 6c73 650a 3030 3030 3031 3930 3a20 3061  lse.00000190: 0a
000006b0: 3230 2032 3032 3020 3230 3635 2036 3336  20 2020 2065 636
000006c0: 3820 3666 3230 2032 3265 3220 3964 3863  8 6f20 22e2 9d8c
000006d0: 2032 3034 6420 202e 2020 2020 6563 686f   204d  .    echo
000006e0: 2022 2e2e 2e20 4d0a 3030 3030 3031 6130   "... M.000001a0
000006f0: 3a20 3639 3733 2037 3336 3920 3665 3637  : 6973 7369 6e67
00000700: 2032 3035 3020 3462 3266 2034 6234 3520   2050 4b2f 4b45 
00000710: 3462 3266 2036 3436 3220 2069 7373 696e  4b2f 6462  issin
00000720: 6720 504b 2f4b 454b 2f64 620a 3030 3030  g PK/KEK/db.0000
00000730: 3031 6230 3a20 3230 3431 2035 3535 3420  01b0: 2041 5554 
00000740: 3438 3230 2036 3236 6320 3666 3632 2037  4820 626c 6f62 7
00000750: 3332 6520 3230 3437 2036 3536 6520 2020  32e 2047 656e   
00000760: 4155 5448 2062 6c6f 6273 2e20 4765 6e0a  AUTH blobs. Gen.
00000770: 3030 3030 3031 6330 3a20 3635 3732 2036  000001c0: 6572 6
00000780: 3137 3420 3635 3230 2037 3736 3920 3734  174 6520 7769 74
00000790: 3638 2032 3032 3720 3661 3735 2037 3337  68 2027 6a75 737
000007a0: 3420 2065 7261 7465 2077 6974 6820 276a  4  erate with 'j
000007b0: 7573 740a 3030 3030 3031 6430 3a20 3230  ust.000001d0: 20
000007c0: 3664 2036 3136 6220 3635 3264 2036 3137  6d 616b 652d 617
000007d0: 3520 3734 3638 2032 3732 3020 3666 3732  5 7468 2720 6f72
000007e0: 2032 3037 3020 2020 6d61 6b65 2d61 7574   2070   make-aut
000007f0: 6827 206f 7220 700a 3030 3030 3031 6530  h' or p.000001e0
00000800: 3a20 3732 3666 2037 3636 3920 3634 3635  : 726f 7669 6465
00000810: 2032 3036 3920 3665 3230 2037 3336 3520   2069 6e20 7365 
00000820: 3633 3735 2037 3236 3520 2072 6f76 6964  6375 7265  rovid
00000830: 6520 696e 2073 6563 7572 650a 3030 3030  e in secure.0000
00000840: 3031 6630 3a20 3632 3666 2036 6637 3420  01f0: 626f 6f74 
00000850: 3566 3633 2036 3537 3220 3734 3733 2032  5f63 6572 7473 2
00000860: 6632 3220 3061 3230 2032 3032 3020 2062  f22 0a20 2020  b
00000870: 6f6f 745f 6365 7274 732f 222e 2020 200a  oot_certs/".   .
00000880: 3030 3030 3032 3030 3a20 3230 3635 2037  00000200: 2065 7
00000890: 3836 3920 3734 3230 2033 3130 6120 3636  869 7420 310a 66
000008a0: 3639 2030 6130 6120 3635 3633 2036 3836  69 0a0a 6563 686
000008b0: 6620 2020 6578 6974 2031 2e66 692e 2e65  f   exit 1.fi..e
000008c0: 6368 6f0a 3030 3030 3032 3130 3a20 3230  cho.00000210: 20
000008d0: 3232 2065 3239 6320 3835 3230 2034 3135  22 e29c 8520 415
000008e0: 3520 3534 3438 2032 3036 3220 3663 3666  5 5448 2062 6c6f
000008f0: 2036 3237 3320 2020 222e 2e2e 2041 5554   6273   "... AUT
00000900: 4820 626c 6f62 730a 3030 3030 3032 3230  H blobs.00000220
00000910: 3a20 3230 3636 2036 6637 3520 3665 3634  : 2066 6f75 6e64
00000920: 2032 3036 3920 3665 3230 2032 3435 3320   2069 6e20 2453 
00000930: 3532 3433 2035 6634 3420 2020 666f 756e  5243 5f44   foun
00000940: 6420 696e 2024 5352 435f 440a 3030 3030  d in $SRC_D.0000
00000950: 3032 3330 3a20 3439 3532 2032 3230 6120  0230: 4952 220a 
00000960: 3663 3733 2032 3032 6420 3663 3230 2032  6c73 202d 6c20 2
00000970: 3232 3420 3533 3532 2034 3335 6620 2049  224 5352 435f  I
00000980: 5222 2e6c 7320 2d6c 2022 2453 5243 5f0a  R".ls -l "$SRC_.
00000990: 3030 3030 3032 3430 3a20 3434 3439 2035  00000240: 4449 5
000009a0: 3232 3220 3266 3762 2035 3034 6220 3263  222 2f7b 504b 2c
000009b0: 3462 2034 3534 6220 3263 3634 2036 3237  4b 454b 2c64 627
000009c0: 6420 2044 4952 222f 7b50 4b2c 4b45 4b2c  d  DIR"/{PK,KEK,
000009d0: 6462 7d0a 3030 3030 3032 3530 3a20 3265  db}.00000250: 2e
000009e0: 3631 2037 3537 3420 3638 3230 2033 3233  61 7574 6820 323
000009f0: 6520 3266 3634 2036 3537 3620 3266 3665  e 2f64 6576 2f6e
00000a00: 2037 3536 6320 202e 6175 7468 2032 3e2f   756c  .auth 2>/
00000a10: 6465 762f 6e75 6c0a 3030 3030 3032 3630  dev/nul.00000260
00000a20: 3a20 3663 3230 2037 6337 6320 3230 3734  : 6c20 7c7c 2074
00000a30: 2037 3237 3520 3635 3061 2030 6120 2020   7275 650a 0a   
00000a40: 2020 2020 2020 2020 2020 206c 207c 7c20             l || 
00000a50: 7472 7565 2e2e 0a                        true...
