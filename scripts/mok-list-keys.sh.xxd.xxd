00000000: 3030 3030 3030 3030 3a20 3233 3231 2032  00000000: 2321 2
00000010: 6637 3520 3733 3732 2032 6636 3220 3639  f75 7372 2f62 69
00000020: 3665 2032 6636 3520 3665 3736 2032 3036  6e 2f65 6e76 206
00000030: 3220 2023 212f 7573 722f 6269 6e2f 656e  2  #!/usr/bin/en
00000040: 7620 620a 3030 3030 3030 3130 3a20 3631  v b.00000010: 61
00000050: 3733 2036 3830 6120 3733 3635 2037 3432  73 680a 7365 742
00000060: 3020 3264 3635 2037 3536 6620 3230 3730  0 2d65 756f 2070
00000070: 2036 3937 3020 2061 7368 2e73 6574 202d   6970  ash.set -
00000080: 6575 6f20 7069 700a 3030 3030 3030 3230  euo pip.00000020
00000090: 3a20 3635 3636 2036 3136 3920 3663 3061  : 6566 6169 6c0a
000000a0: 2036 3336 3420 3230 3232 2032 3432 3820   6364 2022 2428 
000000b0: 3634 3639 2037 3236 6520 2065 6661 696c  6469 726e  efail
000000c0: 2e63 6420 2224 2864 6972 6e0a 3030 3030  .cd "$(dirn.0000
000000d0: 3030 3330 3a20 3631 3664 2036 3532 3020  0030: 616d 6520 
000000e0: 3232 3234 2033 3032 3220 3239 3266 2032  2224 3022 292f 2
000000f0: 6532 6520 3232 3061 2030 6132 3320 2061  e2e 220a 0a23  a
00000100: 6d65 2022 2430 2229 2f2e 2e22 2e2e 230a  me "$0")/.."..#.
00000110: 3030 3030 3030 3430 3a20 3230 3463 2036  00000040: 204c 6
00000120: 3937 3320 3734 3230 2034 6434 6620 3462  973 7420 4d4f 4b
00000130: 3230 2036 3336 3520 3732 3734 2037 3332  20 6365 7274 732
00000140: 6620 2020 4c69 7374 204d 4f4b 2063 6572  f   List MOK cer
00000150: 7473 2f0a 3030 3030 3030 3530 3a20 3662  ts/.00000050: 6b
00000160: 3635 2037 3937 3320 3230 3631 2036 6536  65 7973 2061 6e6
00000170: 3420 3230 3733 2036 3836 6620 3737 3230  4 2073 686f 7720
00000180: 2036 3536 6520 206b 6579 7320 616e 6420   656e  keys and 
00000190: 7368 6f77 2065 6e0a 3030 3030 3030 3630  show en.00000060
000001a0: 3a20 3732 3666 2036 6336 6320 3664 3635  : 726f 6c6c 6d65
000001b0: 2036 6537 3420 3230 3733 2037 3436 3120   6e74 2073 7461 
000001c0: 3734 3735 2037 3332 6520 2072 6f6c 6c6d  7475 732e  rollm
000001d0: 656e 7420 7374 6174 7573 2e0a 3030 3030  ent status..0000
000001e0: 3030 3730 3a20 3061 3233 2032 3035 3520  0070: 0a23 2055 
000001f0: 3733 3631 2036 3736 3520 3361 3230 2036  7361 6765 3a20 6
00000200: 6436 6620 3662 3264 2036 6336 3920 202e  d6f 6b2d 6c69  .
00000210: 2320 5573 6167 653a 206d 6f6b 2d6c 690a  # Usage: mok-li.
00000220: 3030 3030 3030 3830 3a20 3733 3734 2032  00000080: 7374 2
00000230: 6436 6220 3635 3739 2037 3332 6520 3733  d6b 6579 732e 73
00000240: 3638 2030 6132 3320 3230 3533 2036 3336  68 0a23 2053 636
00000250: 3120 2073 742d 6b65 7973 2e73 682e 2320  1  st-keys.sh.# 
00000260: 5363 610a 3030 3030 3030 3930 3a20 3665  Sca.00000090: 6e
00000270: 3733 2032 3036 6620 3735 3734 2032 6636  73 206f 7574 2f6
00000280: 6220 3635 3739 2037 3332 6620 3664 3666  b 6579 732f 6d6f
00000290: 2036 6232 3020 206e 7320 6f75 742f 6b65   6b20  ns out/ke
000002a0: 7973 2f6d 6f6b 200a 3030 3030 3030 6130  ys/mok .000000a0
000002b0: 3a20 3238 3665 2036 3537 3720 3230 3663  : 286e 6577 206c
000002c0: 2036 3137 3920 3666 3735 2037 3432 3920   6179 6f75 7429 
000002d0: 3230 3631 2036 6536 3420 2028 6e65 7720  2061 6e64  (new 
000002e0: 6c61 796f 7574 2920 616e 640a 3030 3030  layout) and.0000
000002f0: 3030 6230 3a20 3230 3663 2036 3536 3720  00b0: 206c 6567 
00000300: 3631 3633 2037 3932 3020 3666 3735 2037  6163 7920 6f75 7
00000310: 3432 6620 3662 3635 2037 3937 3320 2020  42f 6b65 7973   
00000320: 6c65 6761 6379 206f 7574 2f6b 6579 730a  legacy out/keys.
00000330: 3030 3030 3030 6330 3a20 3230 3636 2036  000000c0: 2066 6
00000340: 6637 3220 3230 3633 2036 6636 6420 3730  f72 2063 6f6d 70
00000350: 3631 2037 3436 3920 3632 3639 2036 6336  61 7469 6269 6c6
00000360: 3920 2020 666f 7220 636f 6d70 6174 6962  9   for compatib
00000370: 696c 690a 3030 3030 3030 6430 3a20 3734  ili.000000d0: 74
00000380: 3739 2032 6530 6120 3061 3464 2034 6634  79 2e0a 0a4d 4f4
00000390: 6220 3566 3434 2034 3935 3220 3364 3232  b 5f44 4952 3d22
000003a0: 2036 6637 3520 2074 792e 2e2e 4d4f 4b5f   6f75  ty...MOK_
000003b0: 4449 523d 226f 750a 3030 3030 3030 6530  DIR="ou.000000e0
000003c0: 3a20 3734 3266 2036 6236 3520 3739 3733  : 742f 6b65 7973
000003d0: 2032 6636 6420 3666 3662 2032 3230 6120   2f6d 6f6b 220a 
000003e0: 3463 3435 2034 3734 3120 2074 2f6b 6579  4c45 4741  t/key
000003f0: 732f 6d6f 6b22 2e4c 4547 410a 3030 3030  s/mok".LEGA.0000
00000400: 3030 6630 3a20 3433 3539 2035 6634 3420  00f0: 4359 5f44 
00000410: 3439 3532 2033 6432 3220 3666 3735 2037  4952 3d22 6f75 7
00000420: 3432 6620 3662 3635 2037 3937 3320 2043  42f 6b65 7973  C
00000430: 595f 4449 523d 226f 7574 2f6b 6579 730a  Y_DIR="out/keys.
00000440: 3030 3030 3031 3030 3a20 3232 3061 2030  00000100: 220a 0
00000450: 6136 6320 3639 3733 2037 3435 6620 3633  a6c 6973 745f 63
00000460: 3635 2037 3237 3420 3733 3238 2032 3932  65 7274 7328 292
00000470: 3020 2022 2e2e 6c69 7374 5f63 6572 7473  0  "..list_certs
00000480: 2829 200a 3030 3030 3031 3130 3a20 3762  () .00000110: 7b
00000490: 3061 2032 3032 3020 3233 3230 2035 3037  0a 2020 2320 507
000004a0: 3220 3635 3636 2036 3537 3220 3230 3665  2 6566 6572 206e
000004b0: 2036 3537 3720 207b 2e20 2023 2050 7265   6577  {.  # Pre
000004c0: 6665 7220 6e65 770a 3030 3030 3031 3230  fer new.00000120
000004d0: 3a20 3230 3663 2036 3137 3920 3666 3735  : 206c 6179 6f75
000004e0: 2037 3433 6220 3230 3639 2036 6536 3320   743b 2069 6e63 
000004f0: 3663 3735 2036 3436 3520 2020 6c61 796f  6c75 6465   layo
00000500: 7574 3b20 696e 636c 7564 650a 3030 3030  ut; include.0000
00000510: 3031 3330 3a20 3230 3663 2036 3536 3720  0130: 206c 6567 
00000520: 3631 3633 2037 3932 3020 3631 3733 2032  6163 7920 6173 2
00000530: 3036 3620 3631 3663 2036 6336 3220 2020  066 616c 6c62   
00000540: 6c65 6761 6379 2061 7320 6661 6c6c 620a  legacy as fallb.
00000550: 3030 3030 3031 3430 3a20 3631 3633 2036  00000140: 6163 6
00000560: 6230 6120 3230 3230 2036 3936 3620 3230  b0a 2020 6966 20
00000570: 3562 2032 3032 6420 3634 3230 2032 3232  5b 202d 6420 222
00000580: 3420 2061 636b 2e20 2069 6620 5b20 2d64  4  ack.  if [ -d
00000590: 2022 240a 3030 3030 3031 3530 3a20 3464   "$.00000150: 4d
000005a0: 3466 2034 6235 6620 3434 3439 2035 3232  4f 4b5f 4449 522
000005b0: 3220 3230 3564 2033 6232 3020 3734 3638  2 205d 3b20 7468
000005c0: 2036 3536 6520 204d 4f4b 5f44 4952 2220   656e  MOK_DIR" 
000005d0: 5d3b 2074 6865 6e0a 3030 3030 3031 3630  ]; then.00000160
000005e0: 3a20 3061 3230 2032 3032 3020 3230 3636  : 0a20 2020 2066
000005f0: 2036 3936 6520 3634 3230 2032 3232 3420   696e 6420 2224 
00000600: 3464 3466 2034 6235 6620 202e 2020 2020  4d4f 4b5f  .    
00000610: 6669 6e64 2022 244d 4f4b 5f0a 3030 3030  find "$MOK_.0000
00000620: 3031 3730 3a20 3434 3439 2035 3232 3220  0170: 4449 5222 
00000630: 3230 3264 2036 6436 3120 3738 3634 2036  202d 6d61 7864 6
00000640: 3537 3020 3734 3638 2032 3033 3220 2044  570 7468 2032  D
00000650: 4952 2220 2d6d 6178 6465 7074 6820 320a  IR" -maxdepth 2.
00000660: 3030 3030 3031 3830 3a20 3230 3264 2037  00000180: 202d 7
00000670: 3437 3920 3730 3635 2032 3036 3620 3230  479 7065 2066 20
00000680: 3563 2032 3832 3020 3264 3665 2036 3136  5c 2820 2d6e 616
00000690: 6420 2020 2d74 7970 6520 6620 5c28 202d  d   -type f \( -
000006a0: 6e61 6d0a 3030 3030 3031 3930 3a20 3635  nam.00000190: 65
000006b0: 3230 2032 3732 6120 3265 3633 2037 3237  20 272a 2e63 727
000006c0: 3420 3237 3230 2032 6436 6620 3230 3264  4 2720 2d6f 202d
000006d0: 2036 6536 3120 2065 2027 2a2e 6372 7427   6e61  e '*.crt'
000006e0: 202d 6f20 2d6e 610a 3030 3030 3031 6130   -o -na.000001a0
000006f0: 3a20 3664 3635 2032 3032 3720 3261 3265  : 6d65 2027 2a2e
00000700: 2037 3036 3520 3664 3237 2032 3032 6420   7065 6d27 202d 
00000710: 3666 3230 2032 6436 6520 206d 6520 272a  6f20 2d6e  me '*
00000720: 2e70 656d 2720 2d6f 202d 6e0a 3030 3030  .pem' -o -n.0000
00000730: 3031 6230 3a20 3631 3664 2036 3532 3020  01b0: 616d 6520 
00000740: 3237 3261 2032 6536 3320 3635 3732 2032  272a 2e63 6572 2
00000750: 3732 3020 3264 3666 2032 3032 6420 2061  720 2d6f 202d  a
00000760: 6d65 2027 2a2e 6365 7227 202d 6f20 2d0a  me '*.cer' -o -.
00000770: 3030 3030 3031 6330 3a20 3665 3631 2036  000001c0: 6e61 6
00000780: 6436 3520 3230 3237 2032 6132 6520 3634  d65 2027 2a2e 64
00000790: 3635 2037 3232 3720 3230 3563 2032 3930  65 7227 205c 290
000007a0: 6120 206e 616d 6520 272a 2e64 6572 2720  a  name '*.der' 
000007b0: 5c29 2e0a 3030 3030 3031 6430 3a20 3230  \)..000001d0: 20
000007c0: 3230 2036 3636 3920 3061 3230 2032 3036  20 6669 0a20 206
000007d0: 3920 3636 3230 2035 6232 3020 3264 3634  9 6620 5b20 2d64
000007e0: 2032 3032 3220 2020 2066 692e 2020 6966   2022    fi.  if
000007f0: 205b 202d 6420 220a 3030 3030 3031 6530   [ -d ".000001e0
00000800: 3a20 3234 3463 2034 3534 3720 3431 3433  : 244c 4547 4143
00000810: 2035 3935 6620 3434 3439 2035 3232 3220   595f 4449 5222 
00000820: 3230 3564 2033 6232 3020 2024 4c45 4741  205d 3b20  $LEGA
00000830: 4359 5f44 4952 2220 5d3b 200a 3030 3030  CY_DIR" ]; .0000
00000840: 3031 6630 3a20 3734 3638 2036 3536 6520  01f0: 7468 656e 
00000850: 3061 3230 2032 3032 3020 3230 3636 2036  0a20 2020 2066 6
00000860: 3936 6520 3634 3230 2032 3232 3420 2074  96e 6420 2224  t
00000870: 6865 6e2e 2020 2020 6669 6e64 2022 240a  hen.    find "$.
00000880: 3030 3030 3032 3030 3a20 3463 3435 2034  00000200: 4c45 4
00000890: 3734 3120 3433 3539 2035 6634 3420 3439  741 4359 5f44 49
000008a0: 3532 2032 3232 3020 3264 3664 2036 3137  52 2220 2d6d 617
000008b0: 3820 204c 4547 4143 595f 4449 5222 202d  8  LEGACY_DIR" -
000008c0: 6d61 780a 3030 3030 3032 3130 3a20 3634  max.00000210: 64
000008d0: 3635 2037 3037 3420 3638 3230 2033 3132  65 7074 6820 312
000008e0: 3020 3264 3734 2037 3937 3020 3635 3230  0 2d74 7970 6520
000008f0: 2036 3632 3020 2064 6570 7468 2031 202d   6620  depth 1 -
00000900: 7479 7065 2066 200a 3030 3030 3032 3230  type f .00000220
00000910: 3a20 3563 3238 2032 3032 6420 3665 3631  : 5c28 202d 6e61
00000920: 2036 6436 3520 3230 3237 2032 6132 6520   6d65 2027 2a2e 
00000930: 3633 3732 2037 3432 3720 205c 2820 2d6e  6372 7427  \( -n
00000940: 616d 6520 272a 2e63 7274 270a 3030 3030  ame '*.crt'.0000
00000950: 3032 3330 3a20 3230 3264 2036 6632 3020  0230: 202d 6f20 
00000960: 3264 3665 2036 3136 6420 3635 3230 2032  2d6e 616d 6520 2
00000970: 3732 6120 3265 3730 2036 3536 6420 2020  72a 2e70 656d   
00000980: 2d6f 202d 6e61 6d65 2027 2a2e 7065 6d0a  -o -name '*.pem.
00000990: 3030 3030 3032 3430 3a20 3237 3230 2032  00000240: 2720 2
000009a0: 6436 6620 3230 3264 2036 6536 3120 3664  d6f 202d 6e61 6d
000009b0: 3635 2032 3032 3720 3261 3265 2036 3336  65 2027 2a2e 636
000009c0: 3520 2027 202d 6f20 2d6e 616d 6520 272a  5  ' -o -name '*
000009d0: 2e63 650a 3030 3030 3032 3530 3a20 3732  .ce.00000250: 72
000009e0: 3237 2032 3032 6420 3666 3230 2032 6436  27 202d 6f20 2d6
000009f0: 6520 3631 3664 2036 3532 3020 3237 3261  e 616d 6520 272a
00000a00: 2032 6536 3420 2072 2720 2d6f 202d 6e61   2e64  r' -o -na
00000a10: 6d65 2027 2a2e 640a 3030 3030 3032 3630  me '*.d.00000260
00000a20: 3a20 3635 3732 2032 3732 3020 3563 3239  : 6572 2720 5c29
00000a30: 2030 6132 3020 3230 3636 2036 3930 6120   0a20 2066 690a 
00000a40: 3764 3061 2030 6137 3320 2065 7227 205c  7d0a 0a73  er' \
00000a50: 292e 2020 6669 2e7d 2e2e 730a 3030 3030  ).  fi.}..s.0000
00000a60: 3032 3730 3a20 3638 3631 2033 3135 6620  0270: 6861 315f 
00000a70: 3636 3730 2032 3832 3920 3230 3762 2030  6670 2829 207b 0
00000a80: 6132 3020 3230 3663 2036 6636 3320 2068  a20 206c 6f63  h
00000a90: 6131 5f66 7028 2920 7b2e 2020 6c6f 630a  a1_fp() {.  loc.
00000aa0: 3030 3030 3032 3830 3a20 3631 3663 2032  00000280: 616c 2
00000ab0: 3036 3620 3364 3232 2032 3433 3120 3232  066 3d22 2431 22
00000ac0: 3061 2032 3032 3020 3633 3631 2037 3336  0a 2020 6361 736
00000ad0: 3520 2061 6c20 663d 2224 3122 2e20 2063  5  al f="$1".  c
00000ae0: 6173 650a 3030 3030 3032 3930 3a20 3230  ase.00000290: 20
00000af0: 3232 2032 3437 6220 3636 3233 2032 3332  22 247b 6623 232
00000b00: 6120 3265 3764 2032 3232 3020 3639 3665  a 2e7d 2220 696e
00000b10: 2030 6132 3020 2020 2224 7b66 2323 2a2e   0a20   "${f##*.
00000b20: 7d22 2069 6e2e 200a 3030 3030 3032 6130  }" in. .000002a0
00000b30: 3a20 3230 3230 2032 3036 3420 3635 3732  : 2020 2064 6572
00000b40: 2037 6336 3320 3635 3732 2032 3932 3020   7c63 6572 2920 
00000b50: 3666 3730 2036 3536 6520 2020 2020 6465  6f70 656e     de
00000b60: 727c 6365 7229 206f 7065 6e0a 3030 3030  r|cer) open.0000
00000b70: 3032 6230 3a20 3733 3733 2036 6332 3020  02b0: 7373 6c20 
00000b80: 3738 3335 2033 3033 3920 3230 3264 2036  7835 3039 202d 6
00000b90: 3936 6520 3636 3666 2037 3236 6420 2073  96e 666f 726d  s
00000ba0: 736c 2078 3530 3920 2d69 6e66 6f72 6d0a  sl x509 -inform.
00000bb0: 3030 3030 3032 6330 3a20 3230 3434 2034  000002c0: 2044 4
00000bc0: 3535 3220 3230 3264 2036 3936 6520 3230  552 202d 696e 20
00000bd0: 3232 2032 3436 3620 3232 3230 2032 6436  22 2466 2220 2d6
00000be0: 6520 2020 4445 5220 2d69 6e20 2224 6622  e   DER -in "$f"
00000bf0: 202d 6e0a 3030 3030 3032 6430 3a20 3666   -n.000002d0: 6f
00000c00: 3666 2037 3537 3420 3230 3264 2036 3636  6f 7574 202d 666
00000c10: 3920 3665 3637 2036 3537 3220 3730 3732  9 6e67 6572 7072
00000c20: 2036 3936 6520 206f 6f75 7420 2d66 696e   696e  oout -fin
00000c30: 6765 7270 7269 6e0a 3030 3030 3032 6530  gerprin.000002e0
00000c40: 3a20 3734 3230 2032 6437 3320 3638 3631  : 7420 2d73 6861
00000c50: 2033 3132 3020 3332 3365 2032 6636 3420   3120 323e 2f64 
00000c60: 3635 3736 2032 6636 6520 2074 202d 7368  6576 2f6e  t -sh
00000c70: 6131 2032 3e2f 6465 762f 6e0a 3030 3030  a1 2>/dev/n.0000
00000c80: 3032 6630 3a20 3735 3663 2036 6332 3020  02f0: 756c 6c20 
00000c90: 3763 3230 2037 3336 3520 3634 3230 2032  7c20 7365 6420 2
00000ca0: 3737 3320 3266 3565 2035 3334 3820 2075  773 2f5e 5348  u
00000cb0: 6c6c 207c 2073 6564 2027 732f 5e53 480a  ll | sed 's/^SH.
00000cc0: 3030 3030 3033 3030 3a20 3431 3331 2032  00000300: 4131 2
00000cd0: 3034 3620 3639 3665 2036 3736 3520 3732  046 696e 6765 72
00000ce0: 3730 2037 3236 3920 3665 3734 2033 6432  70 7269 6e74 3d2
00000cf0: 6620 2041 3120 4669 6e67 6572 7072 696e  f  A1 Fingerprin
00000d00: 743d 2f0a 3030 3030 3033 3130 3a20 3266  t=/.00000310: 2f
00000d10: 3237 2032 3037 6320 3230 3734 2037 3232  27 207c 2074 722
00000d20: 3020 3237 3562 2033 6136 6320 3666 3737  0 275b 3a6c 6f77
00000d30: 2036 3537 3220 202f 2720 7c20 7472 2027   6572  /' | tr '
00000d40: 5b3a 6c6f 7765 720a 3030 3030 3033 3230  [:lower.00000320
00000d50: 3a20 3361 3564 2032 3732 3020 3237 3562  : 3a5d 2720 275b
00000d60: 2033 6137 3520 3730 3730 2036 3537 3220   3a75 7070 6572 
00000d70: 3361 3564 2032 3732 3020 203a 5d27 2027  3a5d 2720  :]' '
00000d80: 5b3a 7570 7065 723a 5d27 200a 3030 3030  [:upper:]' .0000
00000d90: 3033 3330 3a20 3362 3362 2030 6132 3020  0330: 3b3b 0a20 
00000da0: 3230 3230 2032 3036 3320 3732 3734 2037  2020 2063 7274 7
00000db0: 6337 3020 3635 3664 2032 3932 3020 203b  c70 656d 2920  ;
00000dc0: 3b2e 2020 2020 6372 747c 7065 6d29 200a  ;.    crt|pem) .
00000dd0: 3030 3030 3033 3430 3a20 3666 3730 2036  00000340: 6f70 6
00000de0: 3536 6520 3733 3733 2036 6332 3020 3738  56e 7373 6c20 78
00000df0: 3335 2033 3033 3920 3230 3264 2036 3936  35 3039 202d 696
00000e00: 6520 206f 7065 6e73 736c 2078 3530 3920  e  openssl x509 
00000e10: 2d69 6e0a 3030 3030 3033 3530 3a20 3230  -in.00000350: 20
00000e20: 3232 2032 3436 3620 3232 3230 2032 6436  22 2466 2220 2d6
00000e30: 6520 3666 3666 2037 3537 3420 3230 3264  e 6f6f 7574 202d
00000e40: 2036 3636 3920 2020 2224 6622 202d 6e6f   6669   "$f" -no
00000e50: 6f75 7420 2d66 690a 3030 3030 3033 3630  out -fi.00000360
00000e60: 3a20 3665 3637 2036 3537 3220 3730 3732  : 6e67 6572 7072
00000e70: 2036 3936 6520 3734 3230 2032 6437 3320   696e 7420 2d73 
00000e80: 3638 3631 2033 3132 3020 206e 6765 7270  6861 3120  ngerp
00000e90: 7269 6e74 202d 7368 6131 200a 3030 3030  rint -sha1 .0000
00000ea0: 3033 3730 3a20 3332 3365 2032 6636 3420  0370: 323e 2f64 
00000eb0: 3635 3736 2032 6636 6520 3735 3663 2036  6576 2f6e 756c 6
00000ec0: 6332 3020 3763 3230 2037 3336 3520 2032  c20 7c20 7365  2
00000ed0: 3e2f 6465 762f 6e75 6c6c 207c 2073 650a  >/dev/null | se.
00000ee0: 3030 3030 3033 3830 3a20 3634 3230 2032  00000380: 6420 2
00000ef0: 3737 3320 3266 3565 2035 3334 3820 3431  773 2f5e 5348 41
00000f00: 3331 2032 3034 3620 3639 3665 2036 3736  31 2046 696e 676
00000f10: 3520 2064 2027 732f 5e53 4841 3120 4669  5  d 's/^SHA1 Fi
00000f20: 6e67 650a 3030 3030 3033 3930 3a20 3732  nge.00000390: 72
00000f30: 3730 2037 3236 3920 3665 3734 2033 6432  70 7269 6e74 3d2
00000f40: 6620 3266 3237 2032 3037 6320 3230 3734  f 2f27 207c 2074
00000f50: 2037 3232 3020 2072 7072 696e 743d 2f2f   7220  rprint=//
00000f60: 2720 7c20 7472 200a 3030 3030 3033 6130  ' | tr .000003a0
00000f70: 3a20 3237 3562 2033 6136 6320 3666 3737  : 275b 3a6c 6f77
00000f80: 2036 3537 3220 3361 3564 2032 3732 3020   6572 3a5d 2720 
00000f90: 3237 3562 2033 6137 3520 2027 5b3a 6c6f  275b 3a75  '[:lo
00000fa0: 7765 723a 5d27 2027 5b3a 750a 3030 3030  wer:]' '[:u.0000
00000fb0: 3033 6230 3a20 3730 3730 2036 3537 3220  03b0: 7070 6572 
00000fc0: 3361 3564 2032 3732 3020 3362 3362 2030  3a5d 2720 3b3b 0
00000fd0: 6132 3020 3230 3230 2032 3032 6120 2070  a20 2020 202a  p
00000fe0: 7065 723a 5d27 203b 3b2e 2020 2020 2a0a  per:]' ;;.    *.
00000ff0: 3030 3030 3033 6330 3a20 3239 3230 2037  000003c0: 2920 7
00001000: 3236 3520 3734 3735 2037 3236 6520 3230  265 7475 726e 20
00001010: 3331 2032 3033 6220 3362 3061 2032 3032  31 203b 3b0a 202
00001020: 3020 2029 2072 6574 7572 6e20 3120 3b3b  0  ) return 1 ;;
00001030: 2e20 200a 3030 3030 3033 6430 3a20 3635  .  .000003d0: 65
00001040: 3733 2036 3136 3320 3061 3764 2030 6130  73 6163 0a7d 0a0
00001050: 6120 3639 3733 2035 6636 3520 3665 3732  a 6973 5f65 6e72
00001060: 2036 6636 6320 2065 7361 632e 7d2e 2e69   6f6c  esac.}..i
00001070: 735f 656e 726f 6c0a 3030 3030 3033 6530  s_enrol.000003e0
00001080: 3a20 3663 3635 2036 3432 3820 3239 3230  : 6c65 6428 2920
00001090: 2037 6230 6120 3230 3230 2036 6336 6620   7b0a 2020 6c6f 
000010a0: 3633 3631 2036 6332 3020 206c 6564 2829  6361 6c20  led()
000010b0: 207b 2e20 206c 6f63 616c 200a 3030 3030   {.  local .0000
000010c0: 3033 6630 3a20 3636 3730 2033 6432 3220  03f0: 6670 3d22 
000010d0: 3234 3331 2032 3230 6120 3230 3230 2037  2431 220a 2020 7
000010e0: 3337 3520 3634 3666 2032 3036 6420 2066  375 646f 206d  f
000010f0: 703d 2224 3122 2e20 2073 7564 6f20 6d0a  p="$1".  sudo m.
00001100: 3030 3030 3034 3030 3a20 3666 3662 2037  00000400: 6f6b 7
00001110: 3537 3420 3639 3663 2032 3032 6420 3264  574 696c 202d 2d
00001120: 3663 2036 3937 3320 3734 3264 2036 3536  6c 6973 742d 656
00001130: 6520 206f 6b75 7469 6c20 2d2d 6c69 7374  e  okutil --list
00001140: 2d65 6e0a 3030 3030 3034 3130 3a20 3732  -en.00000410: 72
00001150: 3666 2036 6336 6320 3635 3634 2032 3033  6f 6c6c 6564 203
00001160: 3220 3365 3266 2036 3436 3520 3736 3266  2 3e2f 6465 762f
00001170: 2036 6537 3520 2072 6f6c 6c65 6420 323e   6e75  rolled 2>
00001180: 2f64 6576 2f6e 750a 3030 3030 3034 3230  /dev/nu.00000420
00001190: 3a20 3663 3663 2032 3037 6320 3230 3734  : 6c6c 207c 2074
000011a0: 2037 3232 3020 3237 3562 2033 6136 6320   7220 275b 3a6c 
000011b0: 3666 3737 2036 3537 3220 206c 6c20 7c20  6f77 6572  ll | 
000011c0: 7472 2027 5b3a 6c6f 7765 720a 3030 3030  tr '[:lower.0000
000011d0: 3034 3330 3a20 3361 3564 2032 3732 3020  0430: 3a5d 2720 
000011e0: 3237 3562 2033 6137 3520 3730 3730 2036  275b 3a75 7070 6
000011f0: 3537 3220 3361 3564 2032 3732 3020 203a  572 3a5d 2720  :
00001200: 5d27 2027 5b3a 7570 7065 723a 5d27 200a  ]' '[:upper:]' .
00001210: 3030 3030 3034 3430 3a20 3763 3230 2036  00000440: 7c20 6
00001220: 3737 3220 3635 3730 2032 3032 6420 3731  772 6570 202d 71
00001230: 3230 2032 3232 3420 3636 3730 2032 3230  20 2224 6670 220
00001240: 6120 207c 2067 7265 7020 2d71 2022 2466  a  | grep -q "$f
00001250: 7022 2e0a 3030 3030 3034 3530 3a20 3764  p"..00000450: 7d
00001260: 3061 2030 6136 3820 3631 3733 2035 6636  0a 0a68 6173 5f6
00001270: 6220 3635 3739 2032 3832 3920 3230 3762  b 6579 2829 207b
00001280: 2030 6132 3020 207d 2e2e 6861 735f 6b65   0a20  }..has_ke
00001290: 7928 2920 7b2e 200a 3030 3030 3034 3630  y() {. .00000460
000012a0: 3a20 3230 3663 2036 6636 3320 3631 3663  : 206c 6f63 616c
000012b0: 2032 3036 3320 3635 3732 2037 3433 6420   2063 6572 743d 
000012c0: 3232 3234 2033 3132 3220 2020 6c6f 6361  2224 3122   loca
000012d0: 6c20 6365 7274 3d22 2431 220a 3030 3030  l cert="$1".0000
000012e0: 3034 3730 3a20 3061 3230 2032 3036 6320  0470: 0a20 206c 
000012f0: 3666 3633 2036 3136 6320 3230 3632 2036  6f63 616c 2062 6
00001300: 3137 3320 3635 3364 2032 3232 3420 202e  173 653d 2224  .
00001310: 2020 6c6f 6361 6c20 6261 7365 3d22 240a    local base="$.
00001320: 3030 3030 3034 3830 3a20 3762 3633 2036  00000480: 7b63 6
00001330: 3537 3220 3734 3235 2032 6532 6120 3764  572 7425 2e2a 7d
00001340: 3232 2030 6132 3020 3230 3562 2032 3032  22 0a20 205b 202
00001350: 6420 207b 6365 7274 252e 2a7d 222e 2020  d  {cert%.*}".  
00001360: 5b20 2d0a 3030 3030 3034 3930 3a20 3636  [ -.00000490: 66
00001370: 3230 2032 3232 3420 3632 3631 2037 3336  20 2224 6261 736
00001380: 3520 3265 3662 2036 3537 3920 3232 3230  5 2e6b 6579 2220
00001390: 2035 6432 3020 2066 2022 2462 6173 652e   5d20  f "$base.
000013a0: 6b65 7922 205d 200a 3030 3030 3034 6130  key" ] .000004a0
000013b0: 3a20 3763 3763 2032 3035 6220 3230 3264  : 7c7c 205b 202d
000013c0: 2036 3632 3020 3232 3234 2037 6236 3220   6620 2224 7b62 
000013d0: 3631 3733 2036 3532 3520 207c 7c20 5b20  6173 6525  || [ 
000013e0: 2d66 2022 247b 6261 7365 250a 3030 3030  -f "${base%.0000
000013f0: 3034 6230 3a20 3235 3265 2036 3337 3220  04b0: 252e 6372 
00001400: 3734 3764 2032 6536 6220 3635 3739 2032  747d 2e6b 6579 2
00001410: 3232 3020 3564 3061 2037 6430 6120 2025  220 5d0a 7d0a  %
00001420: 2e63 7274 7d2e 6b65 7922 205d 2e7d 2e0a  .crt}.key" ].}..
00001430: 3030 3030 3034 6330 3a20 3061 3730 2037  000004c0: 0a70 7
00001440: 3236 3920 3665 3734 2036 3632 3020 3232  269 6e74 6620 22
00001450: 3235 2032 6433 3420 3733 3230 2032 3532  25 2d34 7320 252
00001460: 6420 202e 7072 696e 7466 2022 252d 3473  d  .printf "%-4s
00001470: 2025 2d0a 3030 3030 3034 6430 3a20 3339   %-.000004d0: 39
00001480: 3733 2032 3032 3520 3264 3339 2037 3332  73 2025 2d39 732
00001490: 3020 3235 3264 2033 3433 3220 3733 3230  0 252d 3432 7320
000014a0: 2032 3537 3320 2039 7320 252d 3973 2025   2573  9s %-9s %
000014b0: 2d34 3273 2025 730a 3030 3030 3034 6530  -42s %s.000004e0
000014c0: 3a20 3563 3665 2032 3232 3020 3232 3233  : 5c6e 2220 2223
000014d0: 2032 3232 3020 3232 3435 2034 6535 3220   2220 2245 4e52 
000014e0: 3466 3463 2034 6334 3520 205c 6e22 2022  4f4c 4c45  \n" "
000014f0: 2322 2022 454e 524f 4c4c 450a 3030 3030  #" "ENROLLE.0000
00001500: 3034 6630 3a20 3434 3232 2032 3032 3220  04f0: 4422 2022 
00001510: 3462 3435 2035 3932 3220 3230 3232 2034  4b45 5922 2022 4
00001520: 3634 3920 3465 3437 2034 3535 3220 2044  649 4e47 4552  D
00001530: 2220 224b 4559 2220 2246 494e 4745 520a  " "KEY" "FINGER.
00001540: 3030 3030 3035 3030 3a20 3530 3532 2034  00000500: 5052 4
00001550: 3934 6520 3534 3238 2035 3334 3820 3431  94e 5428 5348 41
00001560: 3331 2032 3932 3220 3230 3232 2034 3334  31 2922 2022 434
00001570: 3520 2050 5249 4e54 2853 4841 3129 2220  5  PRINT(SHA1)" 
00001580: 2243 450a 3030 3030 3035 3130 3a20 3532  "CE.00000510: 52
00001590: 3534 2032 3230 6120 3639 3634 2037 3833  54 220a 6964 783
000015a0: 6420 3330 3061 2037 3736 3820 3639 3663  d 300a 7768 696c
000015b0: 2036 3532 3020 2052 5422 2e69 6478 3d30   6520  RT".idx=0
000015c0: 2e77 6869 6c65 200a 3030 3030 3035 3230  .while .00000520
000015d0: 3a20 3439 3436 2035 3333 6420 3230 3732  : 4946 533d 2072
000015e0: 2036 3536 3120 3634 3230 2032 6437 3220   6561 6420 2d72 
000015f0: 3230 3633 2036 3537 3220 2049 4653 3d20  2063 6572  IFS= 
00001600: 7265 6164 202d 7220 6365 720a 3030 3030  read -r cer.0000
00001610: 3035 3330 3a20 3734 3362 2032 3036 3420  0530: 743b 2064 
00001620: 3666 3061 2032 3032 3020 3562 3230 2032  6f0a 2020 5b20 2
00001630: 6436 6520 3230 3232 2032 3436 3320 2074  d6e 2022 2463  t
00001640: 3b20 646f 2e20 205b 202d 6e20 2224 630a  ; do.  [ -n "$c.
00001650: 3030 3030 3035 3430 3a20 3635 3732 2037  00000540: 6572 7
00001660: 3432 3220 3230 3564 2032 3037 6320 3763  422 205d 207c 7c
00001670: 3230 2036 3336 6620 3665 3734 2036 3936  20 636f 6e74 696
00001680: 6520 2065 7274 2220 5d20 7c7c 2063 6f6e  e  ert" ] || con
00001690: 7469 6e0a 3030 3030 3035 3530 3a20 3735  tin.00000550: 75
000016a0: 3635 2030 6132 3020 3230 3636 2037 3033  65 0a20 2066 703
000016b0: 6420 3234 3238 2037 3336 3820 3631 3331  d 2428 7368 6131
000016c0: 2035 6636 3620 2075 652e 2020 6670 3d24   5f66  ue.  fp=$
000016d0: 2873 6861 315f 660a 3030 3030 3035 3630  (sha1_f.00000560
000016e0: 3a20 3730 3230 2032 3232 3420 3633 3635  : 7020 2224 6365
000016f0: 2037 3237 3420 3232 3230 2037 6337 6320   7274 2220 7c7c 
00001700: 3230 3734 2037 3237 3520 2070 2022 2463  2074 7275  p "$c
00001710: 6572 7422 207c 7c20 7472 750a 3030 3030  ert" || tru.0000
00001720: 3035 3730 3a20 3635 3239 2030 6132 3020  0570: 6529 0a20 
00001730: 3230 3562 2032 3032 6420 3665 3230 2032  205b 202d 6e20 2
00001740: 3232 3420 3636 3730 2032 3232 3020 2065  224 6670 2220  e
00001750: 292e 2020 5b20 2d6e 2022 2466 7022 200a  ).  [ -n "$fp" .
00001760: 3030 3030 3035 3830 3a20 3564 3230 2037  00000580: 5d20 7
00001770: 6337 6320 3230 3633 2036 6636 6520 3734  c7c 2063 6f6e 74
00001780: 3639 2036 6537 3520 3635 3061 2032 3032  69 6e75 650a 202
00001790: 3020 205d 207c 7c20 636f 6e74 696e 7565  0  ] || continue
000017a0: 2e20 200a 3030 3030 3035 3930 3a20 3639  .  .00000590: 69
000017b0: 3634 2037 3833 6420 3234 3238 2032 3836  64 783d 2428 286
000017c0: 3920 3634 3738 2032 6233 3120 3239 3239  9 6478 2b31 2929
000017d0: 2030 6132 3020 2069 6478 3d24 2828 6964   0a20  idx=$((id
000017e0: 782b 3129 292e 200a 3030 3030 3035 6130  x+1)). .000005a0
000017f0: 3a20 3230 3639 2036 3632 3020 3639 3733  : 2069 6620 6973
00001800: 2035 6636 3520 3665 3732 2036 6636 6320   5f65 6e72 6f6c 
00001810: 3663 3635 2036 3432 3020 2020 6966 2069  6c65 6420   if i
00001820: 735f 656e 726f 6c6c 6564 200a 3030 3030  s_enrolled .0000
00001830: 3035 6230 3a20 3232 3234 2036 3637 3020  05b0: 2224 6670 
00001840: 3232 3362 2032 3037 3420 3638 3635 2036  223b 2074 6865 6
00001850: 6532 3020 3635 3364 2032 3235 3920 2022  e20 653d 2259  "
00001860: 2466 7022 3b20 7468 656e 2065 3d22 590a  $fp"; then e="Y.
00001870: 3030 3030 3035 6330 3a20 3435 3533 2032  000005c0: 4553 2
00001880: 3233 6220 3230 3635 2036 6337 3320 3635  23b 2065 6c73 65
00001890: 3230 2036 3533 6420 3232 3665 2036 6632  20 653d 226e 6f2
000018a0: 3220 2045 5322 3b20 656c 7365 2065 3d22  2  ES"; else e="
000018b0: 6e6f 220a 3030 3030 3035 6430 3a20 3362  no".000005d0: 3b
000018c0: 3230 2036 3636 3920 3061 3230 2032 3036  20 6669 0a20 206
000018d0: 3920 3636 3230 2036 3836 3120 3733 3566  9 6620 6861 735f
000018e0: 2036 6236 3520 203b 2066 692e 2020 6966   6b65  ; fi.  if
000018f0: 2068 6173 5f6b 650a 3030 3030 3035 6530   has_ke.000005e0
00001900: 3a20 3739 3230 2032 3232 3420 3633 3635  : 7920 2224 6365
00001910: 2037 3237 3420 3232 3362 2032 3037 3420   7274 223b 2074 
00001920: 3638 3635 2036 6532 3020 2079 2022 2463  6865 6e20  y "$c
00001930: 6572 7422 3b20 7468 656e 200a 3030 3030  ert"; then .0000
00001940: 3035 6630 3a20 3662 3364 2032 3235 3920  05f0: 6b3d 2259 
00001950: 3435 3533 2032 3233 6220 3230 3635 2036  4553 223b 2065 6
00001960: 6337 3320 3635 3230 2036 6233 6420 206b  c73 6520 6b3d  k
00001970: 3d22 5945 5322 3b20 656c 7365 206b 3d0a  ="YES"; else k=.
00001980: 3030 3030 3036 3030 3a20 3232 3665 2036  00000600: 226e 6
00001990: 6632 3220 3362 3230 2036 3636 3920 3061  f22 3b20 6669 0a
000019a0: 3230 2032 3037 3320 3635 3663 2033 6432  20 2073 656c 3d2
000019b0: 3220 2022 6e6f 223b 2066 692e 2020 7365  2  "no"; fi.  se
000019c0: 6c3d 220a 3030 3030 3036 3130 3a20 3232  l=".00000610: 22
000019d0: 3061 2032 3032 3020 3639 3636 2032 3035  0a 2020 6966 205
000019e0: 6220 3230 3232 2032 3437 6220 3462 3464  b 2022 247b 4b4d
000019f0: 2034 6634 3420 2022 2e20 2069 6620 5b20   4f44  ".  if [ 
00001a00: 2224 7b4b 4d4f 440a 3030 3030 3036 3230  "${KMOD.00000620
00001a10: 3a20 3566 3433 2034 3535 3220 3534 3361  : 5f43 4552 543a
00001a20: 2032 6437 6420 3232 3230 2033 6432 3020   2d7d 2220 3d20 
00001a30: 3232 3234 2036 3336 3520 205f 4345 5254  2224 6365  _CERT
00001a40: 3a2d 7d22 203d 2022 2463 650a 3030 3030  :-}" = "$ce.0000
00001a50: 3036 3330 3a20 3732 3734 2032 3232 3020  0630: 7274 2220 
00001a60: 3564 3362 2032 3037 3420 3638 3635 2036  5d3b 2074 6865 6
00001a70: 6532 3020 3733 3635 2036 6333 6420 2072  e20 7365 6c3d  r
00001a80: 7422 205d 3b20 7468 656e 2073 656c 3d0a  t" ]; then sel=.
00001a90: 3030 3030 3036 3430 3a20 3232 3261 2032  00000640: 222a 2
00001aa0: 3233 6220 3230 3636 2036 3930 6120 3230  23b 2066 690a 20
00001ab0: 3230 2037 3037 3220 3639 3665 2037 3436  20 7072 696e 746
00001ac0: 3620 2022 2a22 3b20 6669 2e20 2070 7269  6  "*"; fi.  pri
00001ad0: 6e74 660a 3030 3030 3036 3530 3a20 3230  ntf.00000650: 20
00001ae0: 3232 2032 3532 6420 3334 3733 2032 3032  22 252d 3473 202
00001af0: 3520 3264 3339 2037 3332 3020 3235 3264  5 2d39 7320 252d
00001b00: 2033 3937 3320 2020 2225 2d34 7320 252d   3973   "%-4s %-
00001b10: 3973 2025 2d39 730a 3030 3030 3036 3630  9s %-9s.00000660
00001b20: 3a20 3230 3235 2032 6433 3420 3332 3733  : 2025 2d34 3273
00001b30: 2032 3032 3520 3733 3235 2037 3335 6320   2025 7325 735c 
00001b40: 3665 3232 2032 3032 3220 2020 252d 3432  6e22 2022   %-42
00001b50: 7320 2573 2573 5c6e 2220 220a 3030 3030  s %s%s\n" ".0000
00001b60: 3036 3730 3a20 3234 3639 2036 3437 3820  0670: 2469 6478 
00001b70: 3232 3230 2032 3232 3420 3635 3232 2032  2220 2224 6522 2
00001b80: 3032 3220 3234 3662 2032 3232 3020 2024  022 246b 2220  $
00001b90: 6964 7822 2022 2465 2220 2224 6b22 200a  idx" "$e" "$k" .
00001ba0: 3030 3030 3036 3830 3a20 3232 3234 2036  00000680: 2224 6
00001bb0: 3637 3020 3232 3230 2032 3232 3420 3633  670 2220 2224 63
00001bc0: 3635 2037 3237 3420 3232 3230 2032 3232  65 7274 2220 222
00001bd0: 3420 2022 2466 7022 2022 2463 6572 7422  4  "$fp" "$cert"
00001be0: 2022 240a 3030 3030 3036 3930 3a20 3733   "$.00000690: 73
00001bf0: 3635 2036 6332 3220 3061 3230 2032 3036  65 6c22 0a20 206
00001c00: 3520 3736 3631 2036 6332 3020 3232 3433  5 7661 6c20 2243
00001c10: 2034 3535 3220 2073 656c 222e 2020 6576   4552  sel".  ev
00001c20: 616c 2022 4345 520a 3030 3030 3036 6130  al "CER.000006a0
00001c30: 3a20 3534 3566 2032 3436 3920 3634 3738  : 545f 2469 6478
00001c40: 2033 6435 6320 3232 3234 2036 3336 3520   3d5c 2224 6365 
00001c50: 3732 3734 2035 6332 3220 2054 5f24 6964  7274 5c22  T_$id
00001c60: 783d 5c22 2463 6572 745c 220a 3030 3030  x=\"$cert\".0000
00001c70: 3036 6230 3a20 3232 3061 2036 3436 6620  06b0: 220a 646f 
00001c80: 3665 3635 2032 3033 6320 3230 3363 2032  6e65 203c 203c 2
00001c90: 3836 6320 3639 3733 2037 3435 6620 2022  86c 6973 745f  "
00001ca0: 2e64 6f6e 6520 3c20 3c28 6c69 7374 5f0a  .done < <(list_.
00001cb0: 3030 3030 3036 6330 3a20 3633 3635 2037  000006c0: 6365 7
00001cc0: 3237 3420 3733 3230 2033 3233 6520 3266  274 7320 323e 2f
00001cd0: 3634 2036 3537 3620 3266 3665 2037 3536  64 6576 2f6e 756
00001ce0: 6320 2063 6572 7473 2032 3e2f 6465 762f  c  certs 2>/dev/
00001cf0: 6e75 6c0a 3030 3030 3036 6430 3a20 3663  nul.000006d0: 6c
00001d00: 3239 2030 6130 6120 3639 3636 2032 3035  29 0a0a 6966 205
00001d10: 6220 3230 3232 2032 3436 3920 3634 3738  b 2022 2469 6478
00001d20: 2032 3232 3020 206c 292e 2e69 6620 5b20   2220  l)..if [ 
00001d30: 2224 6964 7822 200a 3030 3030 3036 6530  "$idx" .000006e0
00001d40: 3a20 3364 3230 2033 3032 3020 3564 3362  : 3d20 3020 5d3b
00001d50: 2032 3037 3420 3638 3635 2036 6530 6120   2074 6865 6e0a 
00001d60: 3230 3230 2036 3536 3320 203d 2030 205d  2020 6563  = 0 ]
00001d70: 3b20 7468 656e 2e20 2065 630a 3030 3030  ; then.  ec.0000
00001d80: 3036 6630 3a20 3638 3666 2032 3032 3220  06f0: 686f 2022 
00001d90: 3238 3465 2036 6632 3020 3633 3631 2036  284e 6f20 6361 6
00001da0: 6536 3420 3639 3634 2036 3137 3420 2068  e64 6964 6174  h
00001db0: 6f20 2228 4e6f 2063 616e 6469 6461 740a  o "(No candidat.
00001dc0: 3030 3030 3037 3030 3a20 3635 3230 2034  00000700: 6520 4
00001dd0: 6434 6620 3462 3230 2036 3336 3520 3732  d4f 4b20 6365 72
00001de0: 3734 2036 3936 3620 3639 3633 2036 3137  74 6966 6963 617
00001df0: 3420 2065 204d 4f4b 2063 6572 7469 6669  4  e MOK certifi
00001e00: 6361 740a 3030 3030 3037 3130 3a20 3635  cat.00000710: 65
00001e10: 3733 2032 3036 3620 3666 3735 2036 6536  73 2066 6f75 6e6
00001e20: 3420 3230 3735 2036 6536 3420 3635 3732  4 2075 6e64 6572
00001e30: 2032 3032 3420 2065 7320 666f 756e 6420   2024  es found 
00001e40: 756e 6465 7220 240a 3030 3030 3037 3230  under $.00000720
00001e50: 3a20 3464 3466 2034 6235 6620 3434 3439  : 4d4f 4b5f 4449
00001e60: 2035 3232 3020 3666 3732 2032 3032 3420   5220 6f72 2024 
00001e70: 3463 3435 2034 3734 3120 204d 4f4b 5f44  4c45 4741  MOK_D
00001e80: 4952 206f 7220 244c 4547 410a 3030 3030  IR or $LEGA.0000
00001e90: 3037 3330 3a20 3433 3539 2035 6634 3420  0730: 4359 5f44 
00001ea0: 3439 3532 2032 3932 3220 3061 3230 2032  4952 2922 0a20 2
00001eb0: 3036 3520 3738 3639 2037 3432 3020 2043  065 7869 7420  C
00001ec0: 595f 4449 5229 222e 2020 6578 6974 200a  Y_DIR)".  exit .
00001ed0: 3030 3030 3037 3430 3a20 3330 3061 2036  00000740: 300a 6
00001ee0: 3636 3920 3061 3061 2036 3536 3320 3638  669 0a0a 6563 68
00001ef0: 3666 2030 6136 3920 3636 3230 2035 6232  6f 0a69 6620 5b2
00001f00: 3020 2030 2e66 692e 2e65 6368 6f2e 6966  0  0.fi..echo.if
00001f10: 205b 200a 3030 3030 3037 3530 3a20 3264   [ .00000750: 2d
00001f20: 3665 2032 3032 3220 3234 3762 2034 6234  6e 2022 247b 4b4
00001f30: 6420 3466 3434 2035 6634 3320 3435 3532  d 4f44 5f43 4552
00001f40: 2035 3433 6120 202d 6e20 2224 7b4b 4d4f   543a  -n "${KMO
00001f50: 445f 4345 5254 3a0a 3030 3030 3037 3630  D_CERT:.00000760
00001f60: 3a20 3264 3764 2032 3232 3020 3564 3362  : 2d7d 2220 5d3b
00001f70: 2032 3037 3420 3638 3635 2036 6530 6120   2074 6865 6e0a 
00001f80: 3230 3230 2036 3536 3320 202d 7d22 205d  2020 6563  -}" ]
00001f90: 3b20 7468 656e 2e20 2065 630a 3030 3030  ; then.  ec.0000
00001fa0: 3037 3730 3a20 3638 3666 2032 3032 3220  0770: 686f 2022 
00001fb0: 3533 3635 2036 6336 3520 3633 3734 2036  5365 6c65 6374 6
00001fc0: 3536 3420 3361 3230 2034 6234 6420 2068  564 3a20 4b4d  h
00001fd0: 6f20 2253 656c 6563 7465 643a 204b 4d0a  o "Selected: KM.
00001fe0: 3030 3030 3037 3830 3a20 3466 3434 2035  00000780: 4f44 5
00001ff0: 6634 3320 3435 3532 2035 3433 6420 3234  f43 4552 543d 24
00002000: 3462 2034 6434 6620 3434 3566 2034 3334  4b 4d4f 445f 434
00002010: 3520 204f 445f 4345 5254 3d24 4b4d 4f44  5  OD_CERT=$KMOD
00002020: 5f43 450a 3030 3030 3037 3930 3a20 3532  _CE.00000790: 52
00002030: 3534 2032 3230 6120 3230 3230 2035 6232  54 220a 2020 5b2
00002040: 3020 3264 3665 2032 3032 3220 3234 3762  0 2d6e 2022 247b
00002050: 2034 6234 6420 2052 5422 2e20 205b 202d   4b4d  RT".  [ -
00002060: 6e20 2224 7b4b 4d0a 3030 3030 3037 6130  n "${KM.000007a0
00002070: 3a20 3466 3434 2035 6634 6220 3435 3539  : 4f44 5f4b 4559
00002080: 2033 6132 6420 3764 3232 2032 3035 6420   3a2d 7d22 205d 
00002090: 3230 3236 2032 3632 3020 204f 445f 4b45  2026 2620  OD_KE
000020a0: 593a 2d7d 2220 5d20 2626 200a 3030 3030  Y:-}" ] && .0000
000020b0: 3037 6230 3a20 3635 3633 2036 3836 6620  07b0: 6563 686f 
000020c0: 3230 3232 2032 3032 3020 3230 3230 2032  2022 2020 2020 2
000020d0: 3032 3020 3230 3230 2032 3032 3020 2065  020 2020 2020  e
000020e0: 6368 6f20 2220 2020 2020 2020 2020 200a  cho "          .
000020f0: 3030 3030 3037 6330 3a20 3462 3464 2034  000007c0: 4b4d 4
00002100: 6634 3420 3566 3462 2034 3535 3920 3364  f44 5f4b 4559 3d
00002110: 3234 2034 6234 6420 3466 3434 2035 6634  24 4b4d 4f44 5f4
00002120: 6220 204b 4d4f 445f 4b45 593d 244b 4d4f  b  KMOD_KEY=$KMO
00002130: 445f 4b0a 3030 3030 3037 6430 3a20 3435  D_K.000007d0: 45
00002140: 3539 2032 3232 3020 3763 3763 2032 3037  59 2220 7c7c 207
00002150: 3420 3732 3735 2036 3530 6120 3636 3639  4 7275 650a 6669
00002160: 2030 6120 2020 2045 5922 207c 7c20 7472   0a    EY" || tr
00002170: 7565 2e66 692e 0a                        ue.fi..
