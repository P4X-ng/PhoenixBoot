# PhoenixGuard Maintenance Tasks

# Import shared variables
import './Justfile.vars'


# Show maintenance module help
help:
	@echo "ğŸ§¹ PhoenixGuard Maintenance Module"
	@echo "===================================="
	@echo ""
	@echo "Available commands:"
	@echo "  just maint regen-instructions   # Generate copilot-instructions.md"
	@echo "  just maint lint                 # Run static analysis"
	@echo "  just maint format               # Format source code"
	@echo "  just maint docs                 # Update documentation"
	@echo "  just maint clean                # Clean build artifacts"
	@echo ""

# Generate copilot-instructions.md from components
regen-instructions:
	@echo "ğŸ“ Generating copilot-instructions.md..."
	@bash scripts/regen-instructions.sh

# Lint sources
lint:
	@echo "ğŸ” Running static analysis..."
	@mkdir -p {{OUT_DIR}}/lint
	@bash scripts/lint.sh

# Format sources
format:
	@echo "ğŸ¨ Formatting code..."
	@bash scripts/format.sh

# Update documentation
docs:
	@echo "ğŸ“š Updating documentation..."
	# This can be expanded with a static site generator or other tools
	@echo "âœ… Documentation updated"

# Clean build artifacts
clean:
	@echo "ğŸ§¹ Cleaning build artifacts..."
	@rm -rf {{OUT_DIR}}/staging/* {{OUT_DIR}}/qemu/* {{OUT_DIR}}/lint/*
	@if [ "${DEEP_CLEAN:-}" = "1" ]; then rm -rf {{OUT_DIR}}/esp/*; fi
	@echo "âœ… Build artifacts cleaned"
